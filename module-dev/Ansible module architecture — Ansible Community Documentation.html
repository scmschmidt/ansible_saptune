<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ansible module architecture — Ansible Community Documentation</title>
      <link rel="stylesheet" type="text/css" href="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/pygments.css">
      <link rel="stylesheet" type="text/css" href="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/ansible.css">
      <link rel="stylesheet" type="text/css" href="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/antsibull-minimal.css">
      <link rel="stylesheet" type="text/css" href="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/copybutton.css">
      <link rel="stylesheet" type="text/css" href="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/rtd-ethical-ads.css">

  
    <link rel="shortcut icon" href="https://docs.ansible.com/ansible/latest/_static/images/Ansible-Mark-RGB_Black.png">
    <link rel="canonical" href="https://docs.ansible.com/ansible/latest/dev_guide/developing_program_flow_modules.html">
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script type="text/javascript" async="" src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/js_002"></script><script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/banner.js" type="text/javascript" id="cookieBanner-330046" data-cookieconsent="ignore" data-hs-ignore="true" data-loader="hs-scriptloader" data-hsjs-portal="330046" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script type="text/javascript" async="" src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/js_003"></script><script type="text/javascript" async="" src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/analytics.js"></script><script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/330046.js" type="text/javascript" id="hs-script-loader"></script><script id="hs-analytics" src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/330046_002.js"></script><script async="" src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/gtm.js"></script><script async="" src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/st.js"></script><script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/jquery.js"></script>
        <script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/documentation_options.js"></script>
        <script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/doctools.js"></script>
        <script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/sphinx_highlight.js"></script>
        <script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/clipboard.min.js"></script>
        <script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/copybutton.js"></script>
    <script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/theme.js"></script>
    <link rel="index" title="Index" href="https://docs.ansible.com/ansible/latest/genindex.html">
    <link rel="search" title="Search" href="https://docs.ansible.com/ansible/latest/search.html">
    <link rel="next" title="Python API" href="https://docs.ansible.com/ansible/latest/dev_guide/developing_api.html">
    <link rel="prev" title="ansible-core project branches and tags" href="https://docs.ansible.com/ansible/latest/dev_guide/core_branches_and_tags.html"><!-- extra head elements for Ansible beyond RTD Sphinx Theme -->
<script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/dtm.js"></script><script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/AppMeasurement.min.js" async=""></script><script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/AppMeasurement_Module_ActivityMap.min.js" async=""></script><script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/rh.mktg.js"></script>


<!-- <meta class="swiftype" name="published_at" data-type="date" content="2017-12-13" /> -->
<meta class="swiftype" name="version" data-type="string" content="10">

<!-- Google Tag Manager Data Layer -->
<script>
 dataLayer = [];
</script>
<!-- End Google Tag Manager Data Layer -->



<script>
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','https://s.swiftypecdn.com/install/v2/st.js','_st');

_st('install','yABGvz2N8PwcwBxyfzUc','2.0.0');
</script>

<script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/RC64c4139883b6449e9007dae118d46129-source.min.js" async=""></script><script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/RCb3347083d3c74782ad8b87082d840d03-source.min.js" async=""></script><script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/RCaeae9fdd3ba243ddb2ee3b09b79202c7-source.min.js" async=""></script><script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/RC9bdf9a2dcb6841e1b69b64c7654c3182-source.min.js" async=""></script><script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/RC8fd79e9f4e5942d7b94e766cb5eb9256-source.min.js" async=""></script><script type="text/javascript" src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/elqCfg.min.js"></script><script src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/RC0548ca5c51b34db08240b0dce9707f2f-source.min.js" async=""></script><link rel="stylesheet" type="text/css" href="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/new_embed-2552d8d62d9c60f59b3b11a5d083d1ebd090c72de809fc7c76.css"><style type="text/css">.st-install-yABGvz2N8PwcwBxyfzUc .st-ui-result .st-ui-type-heading { color:#5bbdbf !important }
.st-install-yABGvz2N8PwcwBxyfzUc .st-ui-result em {font-style:normal; font-weight:bold; background-color:#f6fcfe !important}</style><script type="text/javascript" src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/js"></script></head>

<body class="wy-body-for-nav"><!-- extra body elements for Ansible beyond RTD Sphinx Theme -->
<!-- Google Tag Manager -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PSB293" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-PSB293');</script>
<!-- End Google Tag Manager -->

<div class="DocSite-globalNav ansibleNav">
  <ul>
    <li><a href="https://www.ansible.com/blog" target="_blank">Blog</a></li>
    <li><a href="https://forum.ansible.com/" target="_blank">Ansible community forum</a></li>
    <li><a href="https://docs.ansible.com/" target="_blank">Documentation</a></li>
  </ul>
</div>

<a class="DocSite-nav" href="https://docs.ansible.com/" style="padding-bottom: 30px;">

  <img class="DocSiteNav-logo" src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/Ansible-Mark-RGB_White.png" alt="Ansible Logo">
  <div class="DocSiteNav-title">Ansible Community Documentation</div>
</a>
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">

          
          
          <a href="https://docs.ansible.com/ansible/latest/index.html" class="icon icon-home">
            Ansible
          </a>
              <div class="version">
                10
              </div><!--- Based on https://github.com/rtfd/sphinx_rtd_theme/pull/438/files -->

<div class="version">
  
    <form class="version-dropdown" method="get">
      <script>
        function switchVersionTo(slug) {
          var current_url_path = window.location.pathname;
          var url_version = current_url_path.search("/10/") > -1
            ? "/10/"
            : "/latest/";
          var new_version_url = current_url_path.replace(url_version, "/" + slug + "/");
          window.location.replace(new_version_url);
        }
      </script>
      <label class="sr-only" for="version-list">Select version:</label>
      <select class="version-list" id="version-list" onchange="switchVersionTo(this.value);">
        
        <option value="latest" selected="selected">
            latest
        </option>
        
        <option value="9">
            9
        </option>
        
        <option value="2.9">
            2.9
        </option>
        
        <option value="devel">
            devel
        </option>
        
      </select>
    </form>
  
</div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" method="get">
    <label class="sr-only" for="q">Search docs:</label>
    <input type="text" class="st-default-search-input" id="q" name="q" placeholder="Search docs" autocomplete="off" autocorrect="off" autocapitalize="none">
    <input type="hidden" name="check_keywords" value="yes">
    <input type="hidden" name="area" value="default">
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
              <p class="caption" role="heading"><span class="caption-text">Ansible getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/getting_started/index.html">Getting started with Ansible</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/getting_started_ee/index.html">Getting started with Execution Environments</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation, Upgrade &amp; Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/installation_guide/index.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/porting_guides/porting_guides.html">Ansible Porting Guides</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/inventory_guide/index.html">Building Ansible inventories</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/command_guide/index.html">Using Ansible command line tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/playbook_guide/index.html">Using Ansible playbooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/vault_guide/index.html">Protecting sensitive data with Ansible vault</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/module_plugin_guide/index.html">Using Ansible modules and plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/collections_guide/index.html">Using Ansible collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/os_guide/index.html">Using Ansible on Windows and BSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/tips_tricks/index.html">Ansible tips and tricks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/community/index.html">Ansible Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/community/contributions_collections.html">Ansible Collections Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/community/contributions.html">ansible-core Contributors Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/community/advanced_index.html">Advanced Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/dev_guide/style_guide/index.html">Ansible documentation style guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extending Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/dev_guide/index.html">Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Common Ansible Scenarios</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/scenario_guides/cloud_guides.html">Legacy Public Cloud Guides</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Network Automation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/network/getting_started/index.html">Network Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/network/user_guide/index.html">Network Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/network/dev_guide/index.html">Network Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Ansible Galaxy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/galaxy/user_guide.html">Galaxy User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/galaxy/dev_guide.html">Galaxy Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference &amp; Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/collections/index.html">Collection Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/collections/all_plugins.html">Indexes of all modules and plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/playbooks_keywords.html">Playbook Keywords</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/common_return_values.html">Return Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html">Ansible Configuration Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/general_precedence.html">Controlling how Ansible behaves: precedence rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html">YAML Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/python_3_support.html">Python 3 Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/interpreter_discovery.html">Interpreter Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/release_and_maintenance.html">Releases and maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/test_strategies.html">Testing Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/dev_guide/testing/sanity/index.html">Sanity Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/module_utils.html">Ansible Reference: Module Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/special_variables.html">Special Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/tower.html">Red Hat Ansible Automation Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/automationhub.html">Ansible Automation Hub</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/logging.html">Logging Ansible output</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Roadmaps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/roadmap/ansible_roadmap_index.html">Ansible Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.ansible.com/ansible/latest/roadmap/ansible_core_roadmap_index.html">ansible-core Roadmaps</a></li>
</ul>
<!-- extra nav elements for Ansible beyond RTD Sphinx Theme -->
<!-- changeable widget links to tower - do not change as image controlled by Ansible-->
<div id="sideBanner">
  <br>
  <a href="https://www.ansible.com/docs-left?utm_source=docs">
    <img style="border-width:0px;" src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/ASB-docs-left-rail.webp">
  </a>
  <br><br><br>
</div>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="https://docs.ansible.com/ansible/latest/index.html">Ansible</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="https://docs.ansible.com/ansible/latest/index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="https://docs.ansible.com/ansible/latest/dev_guide/index.html">Developer Guide</a></li>
          <li class="breadcrumb-item"><a href="https://docs.ansible.com/ansible/latest/dev_guide/developing_core.html">Developing <code class="docutils literal notranslate"><span class="pre">ansible-core</span></code></a></li>
      <li class="breadcrumb-item active">Ansible module architecture</li>
  <li class="wy-breadcrumbs-aside">
            <!-- Remove main index page as it is no longer editable -->
            
              <a href="https://github.com/ansible/ansible-documentation/edit/devel/docs/docsite/rst/dev_guide/developing_program_flow_modules.rst?description=%23%23%23%23%23%20SUMMARY%0A%3C!---%20Your%20description%20here%20--%3E%0A%0A%0A%23%23%23%23%23%20ISSUE%20TYPE%0A-%20Docs%20Pull%20Request%0A%0A%2Blabel:%20docsite_pr" class="fa fa-github"> Edit on GitHub</a>
            
  </li>
  </ul>
  <hr>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  <script>
    function startsWith(str, needle) {
      return str.slice(0, needle.length) == needle
    }
    function startsWithOneOf(str, needles) {
      return needles.some(function (needle) {
        return startsWith(str, needle);
      });
    }
    var banner = '';
      var extra_banner = '';
    /*use extra_banner for when we want something extra, like a survey or Community Day notice */
   /*  var extra_banner =
      '<div id="latest_extra_banner_id" class="admonition important">' +
        '<p style="padding-bottom: 1.2rem;">' +
        'Discuss Ansible in the new <a href="https://forum.ansible.com/t/welcome-to-the-ansible-community/5">Ansible Forum!</a>' +
        '</p>' +
      '</div>';
      */
    // Create a banner if we're not on the official docs site
    if (location.host == "docs.testing.ansible.com") {
      document.write('<div id="testing_banner_id" class="admonition important">' +
                     '<p>This is the testing site for Ansible Documentation. Unless you are reviewing pre-production changes, please visit the <a href="https://docs.ansible.com/ansible/latest/">official documentation website</a>.</p> <p></p>' +
                     '</div>');
    }
    
      // Create a banner
      current_url_path = window.location.pathname;

      var important = false;
      var msg = '<p>';
      if (startsWith(current_url_path, "/ansible-core/")) {
        msg += 'You are reading documentation for Ansible Core, which contains no plugins except for those in ansible.builtin. For documentation of the Ansible package, go to <a href="/ansible/latest">the latest documentation</a>.';
      } else if (startsWithOneOf(current_url_path, ["/ansible/latest/", "/ansible/10/"])) {
        /* temp extra banner to advertise something */
        banner += extra_banner;

        msg += 'This is the <b>latest</b> (stable) Ansible community documentation. For Red Hat Ansible Automation Platform subscriptions, see <a href="https://access.redhat.com/support/policy/updates/ansible-automation-platform">Life Cycle</a> for version details.';
      } else if (startsWith(current_url_path, "/ansible/2.9/")) {
        msg += 'You are reading the latest Red Hat released version of the Ansible documentation. Community users can use this version, or select <b>latest</b> from the version selector to the left for the most recent community version.';
      } else if (startsWith(current_url_path, "/ansible/devel/")) {
        /* temp extra banner to advertise something */
        banner += extra_banner;

        msg += 'You are reading the <b>devel</b> version of the Ansible documentation - this version is not guaranteed stable. Use the version selection to the left if you want the <b>latest</b> (stable) released version.';
      } else {
        msg += 'You are reading an older version of the Ansible documentation. Use the version selection to the left if you want the <b>latest</b> (stable) released version.';
        /* temp extra banner to advertise something - this is for testing*/
        banner += extra_banner;

      }
      msg += '</p>';

      banner += '<div id="banner_id" class="admonition ';
      banner += important ? 'important' : 'caution';
      banner += '">';
      banner += important ? '<br>' : '';
      banner += msg;
      banner += important ? '<br>' : '';
      banner += '</div>';
      document.write(banner);
    
  </script><div id="banner_id" class="admonition caution"><p>This is the <b>latest</b> (stable) Ansible community documentation. For Red Hat Ansible Automation Platform subscriptions, see <a href="https://access.redhat.com/support/policy/updates/ansible-automation-platform">Life Cycle</a> for version details.</p></div>


  
           <div itemprop="articleBody">
             
  <section id="ansible-module-architecture">
<span id="developing-program-flow-modules"></span><span id="flow-modules"></span><h1>Ansible module architecture<a class="headerlink" href="#ansible-module-architecture" title="Link to this heading"></a></h1>
<p>If you are working on the <code class="docutils literal notranslate"><span class="pre">ansible-core</span></code>
 code, writing an Ansible module, or developing an action plugin, you 
may need to understand how Ansible’s program flow executes. If you are 
just using Ansible Modules in playbooks, you can skip this section.</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#types-of-modules" id="id3">Types of modules</a></p>
<ul>
<li><p><a class="reference internal" href="#action-plugins" id="id4">Action plugins</a></p></li>
<li><p><a class="reference internal" href="#new-style-modules" id="id5">New-style modules</a></p>
<ul>
<li><p><a class="reference internal" href="#python" id="id6">Python</a></p></li>
<li><p><a class="reference internal" href="#powershell" id="id7">PowerShell</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#jsonargs-modules" id="id8">JSONARGS modules</a></p></li>
<li><p><a class="reference internal" href="#non-native-want-json-modules" id="id9">Non-native want JSON modules</a></p></li>
<li><p><a class="reference internal" href="#binary-modules" id="id10">Binary modules</a></p></li>
<li><p><a class="reference internal" href="#old-style-modules" id="id11">Old-style modules</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#how-modules-are-executed" id="id12">How modules are executed</a></p>
<ul>
<li><p><a class="reference internal" href="#executor-task-executor" id="id13">Executor/task_executor</a></p></li>
<li><p><a class="reference internal" href="#the-normal-action-plugin" id="id14">The <code class="docutils literal notranslate"><span class="pre">normal</span></code> action plugin</a></p></li>
<li><p><a class="reference internal" href="#executor-module-common-py" id="id15">Executor/module_common.py</a></p></li>
<li><p><a class="reference internal" href="#assembler-frameworks" id="id16">Assembler frameworks</a></p>
<ul>
<li><p><a class="reference internal" href="#module-replacer-framework" id="id17">Module Replacer framework</a></p></li>
<li><p><a class="reference internal" href="#ansiballz-framework" id="id18">Ansiballz framework</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#passing-args" id="id19">Passing args</a></p></li>
<li><p><a class="reference internal" href="#internal-arguments" id="id20">Internal arguments</a></p>
<ul>
<li><p><a class="reference internal" href="#ansible-no-log" id="id21">_ansible_no_log</a></p></li>
<li><p><a class="reference internal" href="#ansible-debug" id="id22">_ansible_debug</a></p></li>
<li><p><a class="reference internal" href="#ansible-diff" id="id23">_ansible_diff</a></p></li>
<li><p><a class="reference internal" href="#ansible-verbosity" id="id24">_ansible_verbosity</a></p></li>
<li><p><a class="reference internal" href="#ansible-selinux-special-fs" id="id25">_ansible_selinux_special_fs</a></p></li>
<li><p><a class="reference internal" href="#ansible-syslog-facility" id="id26">_ansible_syslog_facility</a></p></li>
<li><p><a class="reference internal" href="#ansible-version" id="id27">_ansible_version</a></p></li>
<li><p><a class="reference internal" href="#ansible-module-name" id="id28">_ansible_module_name</a></p></li>
<li><p><a class="reference internal" href="#ansible-string-conversion-action" id="id29">_ansible_string_conversion_action</a></p></li>
<li><p><a class="reference internal" href="#ansible-keep-remote-files" id="id30">_ansible_keep_remote_files</a></p></li>
<li><p><a class="reference internal" href="#ansible-socket" id="id31">_ansible_socket</a></p></li>
<li><p><a class="reference internal" href="#ansible-shell-executable" id="id32">_ansible_shell_executable</a></p></li>
<li><p><a class="reference internal" href="#ansible-tmpdir" id="id33">_ansible_tmpdir</a></p></li>
<li><p><a class="reference internal" href="#ansible-remote-tmp" id="id34">_ansible_remote_tmp</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#module-return-values-unsafe-strings" id="id35">Module return values &amp; Unsafe strings</a></p></li>
<li><p><a class="reference internal" href="#special-considerations" id="id36">Special considerations</a></p>
<ul>
<li><p><a class="reference internal" href="#pipelining" id="id37">Pipelining</a></p></li>
<li><p><a class="reference internal" href="#why-pass-args-over-stdin" id="id38">Why pass args over stdin?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#ansiblemodule" id="id39">AnsibleModule</a></p>
<ul>
<li><p><a class="reference internal" href="#argument-spec" id="id40">Argument spec</a></p></li>
<li><p><a class="reference internal" href="#dependencies-between-module-options" id="id41">Dependencies between module options</a></p></li>
<li><p><a class="reference internal" href="#declaring-check-mode-support" id="id42">Declaring check mode support</a></p></li>
<li><p><a class="reference internal" href="#adding-file-options" id="id43">Adding file options</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="types-of-modules">
<span id="flow-types-of-modules"></span><h2><a class="toc-backref" href="#id3" role="doc-backlink">Types of modules</a><a class="headerlink" href="#types-of-modules" title="Link to this heading"></a></h2>
<p>Ansible supports several different types of modules in its code base. Some of
these are for backwards compatibility and others are to enable flexibility.</p>
<section id="action-plugins">
<span id="flow-action-plugins"></span><h3><a class="toc-backref" href="#id4" role="doc-backlink">Action plugins</a><a class="headerlink" href="#action-plugins" title="Link to this heading"></a></h3>
<p>Action plugins look like modules to anyone writing a playbook. Usage 
documentation for most action plugins lives inside a module of the same 
name. Some action plugins do all the work, with the module providing 
only documentation. Some action plugins execute modules. The <code class="docutils literal notranslate"><span class="pre">normal</span></code> action plugin executes modules that don’t have special action plugins. Action plugins always execute on the control node.</p>
<p>Some action plugins do all their work on the control node. For
example, the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/debug_module.html#debug-module"><span class="std std-ref">debug</span></a> action plugin (which prints text for
the user to see) and the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/assert_module.html#assert-module"><span class="std std-ref">assert</span></a> action plugin (which
tests whether values in a playbook satisfy certain criteria) execute entirely on the control node.</p>
<p>Most action plugins set up some values on the control node, then invoke an
actual module on the managed node that does something with these values. For example, the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html#template-module"><span class="std std-ref">template</span></a> action plugin takes values from
the user to construct a file in a temporary location on the control node using
variables from the playbook environment. It then transfers the temporary file
to a temporary file on the remote system. After that, it invokes the
<a class="reference internal" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html#copy-module"><span class="std std-ref">copy module</span></a> which operates on the remote system to move the file
into its final location, sets file permissions, and so on.</p>
</section>
<section id="new-style-modules">
<span id="flow-new-style-modules"></span><h3><a class="toc-backref" href="#id5" role="doc-backlink">New-style modules</a><a class="headerlink" href="#new-style-modules" title="Link to this heading"></a></h3>
<p>All of the modules that ship with Ansible fall into this category. 
While you can write modules in any language, all official modules 
(shipped with Ansible) use either Python or PowerShell.</p>
<p>New-style modules have the arguments to the module embedded inside of them in
some manner. Old-style modules must copy a separate file over to the
managed node, which is less efficient as it requires two over-the-wire
connections instead of only one.</p>
<section id="python">
<span id="flow-python-modules"></span><h4><a class="toc-backref" href="#id6" role="doc-backlink">Python</a><a class="headerlink" href="#python" title="Link to this heading"></a></h4>
<p>New-style Python modules use the <a class="reference internal" href="#ansiballz"><span class="std std-ref">Ansiballz framework</span></a> framework for constructing
modules. These modules use imports from <code class="code docutils literal notranslate"><span class="pre">ansible.module_utils</span></code> to pull in
boilerplate module code, such as argument parsing, formatting of return
values as <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html#term-JSON"><span class="xref std std-term">JSON</span></a>, and various file operations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In Ansible, up to version 2.0.x, the official Python modules used the
<a class="reference internal" href="#module-replacer"><span class="std std-ref">Module Replacer framework</span></a> framework.  For module authors, <a class="reference internal" href="#ansiballz"><span class="std std-ref">Ansiballz framework</span></a> is
largely a superset of <a class="reference internal" href="#module-replacer"><span class="std std-ref">Module Replacer framework</span></a> functionality, so you usually
do not need to understand the differences between them.</p>
</div>
</section>
<section id="powershell">
<span id="flow-powershell-modules"></span><h4><a class="toc-backref" href="#id7" role="doc-backlink">PowerShell</a><a class="headerlink" href="#powershell" title="Link to this heading"></a></h4>
<p>New-style PowerShell modules use the <a class="reference internal" href="#module-replacer"><span class="std std-ref">Module Replacer framework</span></a> framework for
constructing modules. These modules get a library of PowerShell code embedded
in them before being sent to the managed node.</p>
</section>
</section>
<section id="jsonargs-modules">
<span id="flow-jsonargs-modules"></span><h3><a class="toc-backref" href="#id8" role="doc-backlink">JSONARGS modules</a><a class="headerlink" href="#jsonargs-modules" title="Link to this heading"></a></h3>
<p>These modules are scripts that include the string
<code class="docutils literal notranslate"><span class="pre">&lt;&lt;INCLUDE_ANSIBLE_MODULE_JSON_ARGS&gt;&gt;</span></code> in their body.
This string is replaced with the JSON-formatted argument string. These modules typically set a variable to that value like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell0"><span></span><span class="n">json_arguments</span> <span class="o">=</span> <span class="s2">"""&lt;&lt;INCLUDE_ANSIBLE_MODULE_JSON_ARGS&gt;&gt;"""</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell0">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
<p>Which is expanded as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell1"><span></span><span class="n">json_arguments</span> <span class="o">=</span> <span class="s2">"""{"param1": "test's quotes", "param2": "</span><span class="se">\"</span><span class="s2">To be or not to be</span><span class="se">\"</span><span class="s2"> - Hamlet"}"""</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell1">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ansible outputs a <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html#term-JSON"><span class="xref std std-term">JSON</span></a> string with bare quotes. Double quotes are
used to quote string values, double quotes inside of string values are
backslash escaped, and single quotes may appear unescaped inside of
a string value. To use JSONARGS, your scripting language must have a way
to handle this type of string. The example uses Python’s triple quoted
strings to do this. Other scripting languages may have a similar quote
character that won’t be confused by any quotes in the JSON or it may
allow you to define your own start-of-quote and end-of-quote characters.
If the language doesn’t give you any of these then you’ll need to write
a <a class="reference internal" href="#flow-want-json-modules"><span class="std std-ref">non-native JSON module</span></a> or
<a class="reference internal" href="#flow-old-style-modules"><span class="std std-ref">Old-style module</span></a> instead.</p>
</div>
<p>These modules typically parse the contents of <code class="docutils literal notranslate"><span class="pre">json_arguments</span></code> using a JSON
library and then use them as native variables throughout the code.</p>
</section>
<section id="non-native-want-json-modules">
<span id="flow-want-json-modules"></span><h3><a class="toc-backref" href="#id9" role="doc-backlink">Non-native want JSON modules</a><a class="headerlink" href="#non-native-want-json-modules" title="Link to this heading"></a></h3>
<p>If a module has the string <code class="docutils literal notranslate"><span class="pre">WANT_JSON</span></code> in it anywhere, Ansible treats
it as a non-native module that accepts a file name as its only command-line
parameter. The file name is for a temporary file containing a <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html#term-JSON"><span class="xref std std-term">JSON</span></a>
string containing the module’s parameters. The module needs to open the file,
read and parse the parameters, operate on the data, and print its return data
as a JSON encoded dictionary to stdout before exiting.</p>
<p>These types of modules are self-contained entities. As of Ansible 2.1, Ansible
only modifies them to change a shebang line if present.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Examples of Non-native modules written in ruby are in the <a class="reference external" href="https://github.com/ansible/ansible-for-rubyists">Ansible
for Rubyists</a> repository.</p>
</div>
</section>
<section id="binary-modules">
<span id="flow-binary-modules"></span><h3><a class="toc-backref" href="#id10" role="doc-backlink">Binary modules</a><a class="headerlink" href="#binary-modules" title="Link to this heading"></a></h3>
<p>From Ansible 2.2 onwards, modules may also be small binary programs. Ansible
doesn’t perform any magic to make these portable to different systems so they
may be specific to the system on which they were compiled or require other
binary runtime dependencies. Despite these drawbacks, you may have
to compile a custom module against a specific binary
library if that’s the only way to get access to certain resources.</p>
<p>Binary modules take their arguments and return data to Ansible in the same
way as <a class="reference internal" href="#flow-want-json-modules"><span class="std std-ref">want JSON modules</span></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>One example of a <a class="reference external" href="https://github.com/ansible/ansible/blob/devel/test/integration/targets/binary_modules/library/helloworld.go">binary module</a>
written in go.</p>
</div>
</section>
<section id="old-style-modules">
<span id="flow-old-style-modules"></span><h3><a class="toc-backref" href="#id11" role="doc-backlink">Old-style modules</a><a class="headerlink" href="#old-style-modules" title="Link to this heading"></a></h3>
<p>Old-style modules are similar to
<a class="reference internal" href="#flow-want-json-modules"><span class="std std-ref">want JSON modules</span></a>, except that the file that
they take contains <code class="docutils literal notranslate"><span class="pre">key=value</span></code> pairs for their parameters instead of
<a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html#term-JSON"><span class="xref std std-term">JSON</span></a>. Ansible decides that a module is old-style when it doesn’t have
any of the markers that would show that it is one of the other types.</p>
</section>
</section>
<section id="how-modules-are-executed">
<span id="flow-how-modules-are-executed"></span><h2><a class="toc-backref" href="#id12" role="doc-backlink">How modules are executed</a><a class="headerlink" href="#how-modules-are-executed" title="Link to this heading"></a></h2>
<p>When a user uses <strong class="program">ansible</strong> or <strong class="program">ansible-playbook</strong>, they
specify a task to execute. The task is usually the name of a module along
with several parameters to be passed to the module. Ansible takes these
values and processes them in various ways before they are finally executed on
the remote machine.</p>
<section id="executor-task-executor">
<span id="flow-executor-task-executor"></span><h3><a class="toc-backref" href="#id13" role="doc-backlink">Executor/task_executor</a><a class="headerlink" href="#executor-task-executor" title="Link to this heading"></a></h3>
<p>The TaskExecutor receives the module name and parameters that were parsed from
the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html#term-Playbooks"><span class="xref std std-term">playbook</span></a> (or from the command-line in the case of
<strong class="command">/usr/bin/ansible</strong>). It uses the name to decide whether it is looking
at a module or an <a class="reference internal" href="#flow-action-plugins"><span class="std std-ref">Action Plugin</span></a>. If it is
a module, it loads the <a class="reference internal" href="#flow-normal-action-plugin"><span class="std std-ref">Normal Action Plugin</span></a>
and passes the name, variables, and other information about the task and play
to that Action Plugin for further processing.</p>
</section>
<section id="the-normal-action-plugin">
<span id="flow-normal-action-plugin"></span><h3><a class="toc-backref" href="#id14" role="doc-backlink">The <code class="docutils literal notranslate"><span class="pre">normal</span></code> action plugin</a><a class="headerlink" href="#the-normal-action-plugin" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">normal</span></code> action plugin executes the module on the remote host. It is
the primary coordinator of much of the work to actually execute the module on
the managed machine.</p>
<ul class="simple">
<li><p>It loads the appropriate connection plugin for the task, which then transfers
or executes as needed to create a connection to that host.</p></li>
<li><p>It adds any internal Ansible properties to the module’s parameters (for
instance, the ones that pass along <code class="docutils literal notranslate"><span class="pre">no_log</span></code> to the module).</p></li>
<li><p>It works with other plugins (connection, shell, become, other action plugins)
to create any temporary files on the remote machine and
cleans up afterwards.</p></li>
<li><p>It pushes the module and module parameters to the
remote host, although the <a class="reference internal" href="#flow-executor-module-common"><span class="std std-ref">module_common</span></a>
code described in the next section decides which format
those will take.</p></li>
<li><p>It handles any special cases regarding modules (for example, 
async
execution, or complications around Windows modules that must have the 
same names as Python modules, so that internal calling of modules from 
other Action Plugins work.)</p></li>
</ul>
<p>Much of this functionality comes from the <cite>BaseAction</cite> class,
which lives in <code class="file docutils literal notranslate"><span class="pre">plugins/action/__init__.py</span></code>. It uses the
<code class="docutils literal notranslate"><span class="pre">Connection</span></code> and <code class="docutils literal notranslate"><span class="pre">Shell</span></code> objects to do its work.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html#term-Tasks"><span class="xref std std-term">tasks</span></a> are run with the <code class="docutils literal notranslate"><span class="pre">async:</span></code> parameter, Ansible
uses the <code class="docutils literal notranslate"><span class="pre">async</span></code> Action Plugin instead of the <code class="docutils literal notranslate"><span class="pre">normal</span></code> Action Plugin
to invoke it. That program flow is currently not documented. Read the
source for information on how that works.</p>
</div>
</section>
<section id="executor-module-common-py">
<span id="flow-executor-module-common"></span><h3><a class="toc-backref" href="#id15" role="doc-backlink">Executor/module_common.py</a><a class="headerlink" href="#executor-module-common-py" title="Link to this heading"></a></h3>
<p>Code in <code class="file docutils literal notranslate"><span class="pre">executor/module_common.py</span></code> assembles the module
to be shipped to the managed node. The module is first read in, then examined
to determine its type:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#flow-powershell-modules"><span class="std std-ref">PowerShell</span></a> and <a class="reference internal" href="#flow-jsonargs-modules"><span class="std std-ref">JSON-args modules</span></a> are passed through <a class="reference internal" href="#module-replacer"><span class="std std-ref">Module Replacer</span></a>.</p></li>
<li><p>New-style <a class="reference internal" href="#flow-python-modules"><span class="std std-ref">Python modules</span></a> are assembled by <a class="reference internal" href="#ansiballz"><span class="std std-ref">Ansiballz framework</span></a>.</p></li>
<li><p><a class="reference internal" href="#flow-want-json-modules"><span class="std std-ref">Non-native-want-JSON</span></a>, <a class="reference internal" href="#flow-binary-modules"><span class="std std-ref">Binary modules</span></a>, and <a class="reference internal" href="#flow-old-style-modules"><span class="std std-ref">Old-Style modules</span></a> aren’t touched by either of these and pass through unchanged.</p></li>
</ul>
<p>After the assembling step, one final
modification is made to all modules that have a shebang line. Ansible checks
whether the interpreter in the shebang line has a specific path configured with
an <code class="docutils literal notranslate"><span class="pre">ansible_$X_interpreter</span></code> inventory variable. If it does, Ansible
substitutes that path for the interpreter path given in the module. After
this, Ansible returns the complete module data and the module type to the
<a class="reference internal" href="#flow-normal-action-plugin"><span class="std std-ref">Normal Action</span></a> which continues execution of
the module.</p>
</section>
<section id="assembler-frameworks">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Assembler frameworks</a><a class="headerlink" href="#assembler-frameworks" title="Link to this heading"></a></h3>
<p>Ansible supports two assembler frameworks: Ansiballz and the older Module Replacer.</p>
<section id="module-replacer-framework">
<span id="module-replacer"></span><h4><a class="toc-backref" href="#id17" role="doc-backlink">Module Replacer framework</a><a class="headerlink" href="#module-replacer-framework" title="Link to this heading"></a></h4>
<p>The Module Replacer framework is the original framework implementing new-style
modules, and is still used for PowerShell modules. It is essentially a preprocessor (like the C Preprocessor for those
familiar with that programming language). It does straight substitutions of
specific substring patterns in the module file. There are two types of
substitutions:</p>
<ul class="simple">
<li><p>Replacements that only happen in the module file. These are public
replacement strings that modules can utilize to get helpful boilerplate or
access to arguments.</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">ansible.module_utils.MOD_LIB_NAME</span> <span class="pre">import</span> <span class="pre">*</span></code> is replaced with the
contents of the <code class="file docutils literal notranslate"><span class="pre">ansible/module_utils/MOD_LIB_NAME.py</span></code>  These should
only be used with <a class="reference internal" href="#flow-python-modules"><span class="std std-ref">new-style Python modules</span></a>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">#&lt;&lt;INCLUDE_ANSIBLE_MODULE_COMMON&gt;&gt;</span></code> is equivalent to
<code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">ansible.module_utils.basic</span> <span class="pre">import</span> <span class="pre">*</span></code> and should also only apply
to new-style Python modules.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">#</span> <span class="pre">POWERSHELL_COMMON</span></code> substitutes the contents of
<code class="file docutils literal notranslate"><span class="pre">ansible/module_utils/powershell.ps1</span></code>. It should only be used with
<a class="reference internal" href="#flow-powershell-modules"><span class="std std-ref">new-style Powershell modules</span></a>.</p></li>
</ul>
</li>
<li><p>Replacements that are used by <code class="docutils literal notranslate"><span class="pre">ansible.module_utils</span></code>
 code. These are internal replacement patterns. They may be used 
internally, in the above public replacements, but shouldn’t be used 
directly by modules.</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">"&lt;&lt;ANSIBLE_VERSION&gt;&gt;"</span></code> is substituted with the Ansible version.  In
<a class="reference internal" href="#flow-python-modules"><span class="std std-ref">new-style Python modules</span></a> under the
<a class="reference internal" href="#ansiballz"><span class="std std-ref">Ansiballz framework</span></a> framework the proper way is to instead instantiate an
<cite>AnsibleModule</cite> and then access the version from
:attr:<code class="docutils literal notranslate"><span class="pre">AnsibleModule.ansible_version</span></code>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">"&lt;&lt;INCLUDE_ANSIBLE_MODULE_COMPLEX_ARGS&gt;&gt;"</span></code> is substituted with
a string which is the Python <code class="docutils literal notranslate"><span class="pre">repr</span></code> of the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html#term-JSON"><span class="xref std std-term">JSON</span></a> encoded module
parameters. Using <code class="docutils literal notranslate"><span class="pre">repr</span></code> on the JSON string makes it safe to embed in
a Python file. In new-style Python modules under the Ansiballz framework
this is better accessed by instantiating an <cite>AnsibleModule</cite> and
then using <a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#AnsibleModule.params" title="AnsibleModule.params"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AnsibleModule.params</span></code></a>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&lt;&lt;SELINUX_SPECIAL_FILESYSTEMS&gt;&gt;</span></code> substitutes a string which is
a comma-separated list of file systems which have a file system dependent
security context in SELinux. In new-style Python modules, if you really
need this you should instantiate an <cite>AnsibleModule</cite> and then use
<a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#AnsibleModule._selinux_special_fs" title="AnsibleModule._selinux_special_fs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AnsibleModule._selinux_special_fs</span></code></a>. The variable has also changed
from a comma-separated string of file system names to an actual python
list of file system names.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&lt;&lt;INCLUDE_ANSIBLE_MODULE_JSON_ARGS&gt;&gt;</span></code> substitutes the module
parameters as a JSON string. Care must be taken to properly quote the
string as JSON data may contain quotes. This pattern is not substituted
in new-style Python modules as they can get the module parameters another
way.</p></li>
<li><p>The string <code class="code docutils literal notranslate"><span class="pre">syslog.LOG_USER</span></code> is replaced wherever it occurs with the
<code class="docutils literal notranslate"><span class="pre">syslog_facility</span></code> which was named in <code class="file docutils literal notranslate"><span class="pre">ansible.cfg</span></code> or any
<code class="docutils literal notranslate"><span class="pre">ansible_syslog_facility</span></code> inventory variable that applies to this host.  In
new-style Python modules this has changed slightly. If you really need to
access it, you should instantiate an <cite>AnsibleModule</cite> and then use
<a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#AnsibleModule._syslog_facility" title="AnsibleModule._syslog_facility"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AnsibleModule._syslog_facility</span></code></a> to access it. It is no longer the
actual syslog facility and is now the name of the syslog facility. See
the <a class="reference internal" href="#flow-internal-arguments"><span class="std std-ref">documentation on internal arguments</span></a>
for details.</p></li>
</ul>
</li>
</ul>
</section>
<section id="ansiballz-framework">
<span id="ansiballz"></span><h4><a class="toc-backref" href="#id18" role="doc-backlink">Ansiballz framework</a><a class="headerlink" href="#ansiballz-framework" title="Link to this heading"></a></h4>
<p>The Ansiballz framework was adopted in Ansible 2.1 and is used for 
all new-style Python modules. Unlike the Module Replacer, Ansiballz uses
 real Python imports of things in
<code class="file docutils literal notranslate"><span class="pre">ansible/module_utils</span></code> instead of merely preprocessing the module. It
does this by constructing a zipfile – which includes the module file, files
in <code class="file docutils literal notranslate"><span class="pre">ansible/module_utils</span></code> that are imported by the module, and some
boilerplate to pass in the module’s parameters. The zipfile is then Base64
encoded and wrapped in a small Python script which decodes the Base64 encoding
and places the zipfile into a temp directory on the managed node. It then
extracts just the Ansible module script from the zip file and places that in
the temporary directory as well. Then it sets the PYTHONPATH to find Python
modules inside of the zip file and imports the Ansible module as the special name, <code class="docutils literal notranslate"><span class="pre">__main__</span></code>.
Importing it as <code class="docutils literal notranslate"><span class="pre">__main__</span></code>
 causes Python to think that it is executing a script rather than simply
importing a module. This lets Ansible run both the wrapper script and 
the module code in a single copy of Python on the remote machine.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><p>Ansible wraps the zipfile in the Python script for two reasons:</p>
<blockquote>
<div><ul class="simple">
<li><p>for compatibility with Python 2.6 which has a less
functional version of Python’s <code class="docutils literal notranslate"><span class="pre">-m</span></code> command-line switch.</p></li>
<li><p>so that pipelining will function properly. Pipelining needs to pipe the
Python module into the Python interpreter on the remote node. Python
understands scripts on stdin but does not understand zip files.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Prior to Ansible 2.7, the module was executed by a second Python interpreter instead of being
executed inside of the same process. This change was made once Python-2.4 support was dropped
to speed up module execution.</p></li>
</ul>
</div>
<p>In Ansiballz, any imports of Python modules from the
<a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#module-ansible.module_utils" title="ansible.module_utils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ansible.module_utils</span></code></a> package trigger inclusion of that Python file
into the zipfile. Instances of <code class="code docutils literal notranslate"><span class="pre">#&lt;&lt;INCLUDE_ANSIBLE_MODULE_COMMON&gt;&gt;</span></code> in
the module are turned into <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">ansible.module_utils.basic</span> <span class="pre">import</span> <span class="pre">*</span></code>
and <code class="file docutils literal notranslate"><span class="pre">ansible/module-utils/basic.py</span></code> is then included in the zipfile.
Files that are included from <code class="file docutils literal notranslate"><span class="pre">module_utils</span></code> are themselves scanned for
imports of other Python modules from <code class="file docutils literal notranslate"><span class="pre">module_utils</span></code> to be included in
the zipfile as well.</p>
</section>
</section>
<section id="passing-args">
<span id="flow-passing-module-args"></span><h3><a class="toc-backref" href="#id19" role="doc-backlink">Passing args</a><a class="headerlink" href="#passing-args" title="Link to this heading"></a></h3>
<p>Arguments are passed differently by the two frameworks:</p>
<ul class="simple">
<li><p>In <a class="reference internal" href="#module-replacer"><span class="std std-ref">Module Replacer framework</span></a>, module arguments are turned into a JSON-ified string and substituted into the combined module file.</p></li>
<li><p>In <a class="reference internal" href="#ansiballz"><span class="std std-ref">Ansiballz framework</span></a>,
 the JSON-ified string is part of the script which wraps the zipfile. 
Just before the wrapper script imports the Ansible module as <code class="docutils literal notranslate"><span class="pre">__main__</span></code>, it monkey-patches the private, <code class="docutils literal notranslate"><span class="pre">_ANSIBLE_ARGS</span></code> variable in <code class="docutils literal notranslate"><span class="pre">basic.py</span></code> with the variable values. When a <a class="reference external" href="https://docs.ansible.com/ansible/2.9/reference_appendices/module_utils.html#ansible.module_utils.basic.AnsibleModule" title="(in Ansible v2.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ansible.module_utils.basic.AnsibleModule</span></code></a> is instantiated, it parses this string and places the args into <a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#AnsibleModule.params" title="AnsibleModule.params"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AnsibleModule.params</span></code></a> where it can be accessed by the module’s other code.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you are writing modules, remember that the way we pass arguments 
is an internal implementation detail: it has changed in the past and 
will change again as soon as changes to the common module_utils
code allow Ansible modules to forgo using <a class="reference external" href="https://docs.ansible.com/ansible/2.9/reference_appendices/module_utils.html#ansible.module_utils.basic.AnsibleModule" title="(in Ansible v2.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ansible.module_utils.basic.AnsibleModule</span></code></a>. Do not rely on the internal global <code class="docutils literal notranslate"><span class="pre">_ANSIBLE_ARGS</span></code> variable.</p>
<p>Very dynamic custom modules which need to parse arguments before they
instantiate an <code class="docutils literal notranslate"><span class="pre">AnsibleModule</span></code> may use <code class="docutils literal notranslate"><span class="pre">_load_params</span></code> to retrieve those parameters.
Although <code class="docutils literal notranslate"><span class="pre">_load_params</span></code> may change in breaking ways if necessary to support
changes in the code, it is likely to be more stable than either the way we pass parameters or the internal global variable.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Prior to Ansible 2.7, the Ansible module was invoked in a second Python interpreter and the
arguments were then passed to the script over the script’s stdin.</p>
</div>
</section>
<section id="internal-arguments">
<span id="flow-internal-arguments"></span><h3><a class="toc-backref" href="#id20" role="doc-backlink">Internal arguments</a><a class="headerlink" href="#internal-arguments" title="Link to this heading"></a></h3>
<p>Both <a class="reference internal" href="#module-replacer"><span class="std std-ref">Module Replacer framework</span></a> and <a class="reference internal" href="#ansiballz"><span class="std std-ref">Ansiballz framework</span></a> send additional arguments to
the Ansible module beyond those which the user specified in the playbook. These
additional arguments are internal parameters that help implement global
Ansible features. Modules often do not need to know about these explicitly because
the features are implemented in <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/module_utils.html#module-ansible.module_utils.basic" title="ansible.module_utils.basic"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ansible.module_utils.basic</span></code></a>. However, certain
features need support from modules and some knowledge of the internal arguments is useful.</p>
<p>The internal arguments in this section are global. If you need to add
 a local internal argument to a custom module, create an action plugin 
for that specific module. See <code class="docutils literal notranslate"><span class="pre">_original_basename</span></code> in the <a class="reference external" href="https://github.com/ansible/ansible/blob/devel/lib/ansible/plugins/action/copy.py#L329">copy action plugin</a> for an example.</p>
<section id="ansible-no-log">
<h4><a class="toc-backref" href="#id21" role="doc-backlink">_ansible_no_log</a><a class="headerlink" href="#ansible-no-log" title="Link to this heading"></a></h4>
<p>Type: <code class="docutils literal notranslate"><span class="pre">bool</span></code></p>
<p>Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> whenever an argument in a task or play specifies <code class="docutils literal notranslate"><span class="pre">no_log</span></code>. Any module that calls the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#AnsibleModule.log" title="AnsibleModule.log"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AnsibleModule.log()</span></code></a>
 function handles this action automatically. If you have a module that 
implements its own logging then you need to check the value of <code class="docutils literal notranslate"><span class="pre">_ansible_no_log</span></code>. To access <code class="docutils literal notranslate"><span class="pre">_ansible_no_log</span></code> in a module, instantiate the <code class="docutils literal notranslate"><span class="pre">AnsibleModule</span></code> utility and then check the value of <a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#AnsibleModule.no_log" title="AnsibleModule.no_log"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AnsibleModule.no_log</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">no_log</span></code> specified in a module’s <code class="docutils literal notranslate"><span class="pre">argument_spec</span></code> is handled by a different mechanism.</p>
</div>
</section>
<section id="ansible-debug">
<h4><a class="toc-backref" href="#id22" role="doc-backlink">_ansible_debug</a><a class="headerlink" href="#ansible-debug" title="Link to this heading"></a></h4>
<p>Type: <code class="docutils literal notranslate"><span class="pre">bool</span></code></p>
<p>Operates verbose logging and logging of external commands that a module executes. If the module uses the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#AnsibleModule.debug" title="AnsibleModule.debug"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AnsibleModule.debug()</span></code></a> function rather than the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#AnsibleModule.log" title="AnsibleModule.log"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AnsibleModule.log()</span></code></a> function then the messages are only logged if you set the <code class="docutils literal notranslate"><span class="pre">_ansible_debug</span></code> argument to <code class="docutils literal notranslate"><span class="pre">True</span></code>. To access <code class="docutils literal notranslate"><span class="pre">_ansible_debug</span></code> in a module, instantiate the <code class="docutils literal notranslate"><span class="pre">AnsibleModule</span></code> utility and access <a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#AnsibleModule._debug" title="AnsibleModule._debug"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AnsibleModule._debug</span></code></a>. For more details, see <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#default-debug"><span class="std std-ref">DEFAULT_DEBUG</span></a>.</p>
</section>
<section id="ansible-diff">
<h4><a class="toc-backref" href="#id23" role="doc-backlink">_ansible_diff</a><a class="headerlink" href="#ansible-diff" title="Link to this heading"></a></h4>
<p>Type: <code class="docutils literal notranslate"><span class="pre">bool</span></code></p>
<p>With this parameter you can configure your module to show a unified 
diff of changes that will be applied to the templated files. To access <code class="docutils literal notranslate"><span class="pre">_ansible_diff</span></code> in a module, instantiate the <code class="docutils literal notranslate"><span class="pre">AnsibleModule</span></code> utility and access <a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#AnsibleModule._diff" title="AnsibleModule._diff"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AnsibleModule._diff</span></code></a>. You can also access this parameter using the <code class="docutils literal notranslate"><span class="pre">diff</span></code> keyword in your playbook, or the relevant environment variable. For more details, see <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/playbooks_keywords.html#playbook-keywords"><span class="std std-ref">Playbook Keywords</span></a> and the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#diff-always"><span class="std std-ref">DIFF_ALWAYS</span></a> configuration option.</p>
</section>
<section id="ansible-verbosity">
<h4><a class="toc-backref" href="#id24" role="doc-backlink">_ansible_verbosity</a><a class="headerlink" href="#ansible-verbosity" title="Link to this heading"></a></h4>
<p>Type: <code class="docutils literal notranslate"><span class="pre">int</span></code></p>
<p>You can use this argument to control the level (0 for none) of verbosity in logging.</p>
</section>
<section id="ansible-selinux-special-fs">
<h4><a class="toc-backref" href="#id25" role="doc-backlink">_ansible_selinux_special_fs</a><a class="headerlink" href="#ansible-selinux-special-fs" title="Link to this heading"></a></h4>
<p>Type: <code class="docutils literal notranslate"><span class="pre">list</span></code>
Elements: <code class="docutils literal notranslate"><span class="pre">strings</span></code></p>
<p>This argument provides modules with the names of file systems which should have a special SELinux context. They are used by the <code class="docutils literal notranslate"><span class="pre">AnsibleModule</span></code> methods which operate on files (changing attributes, moving, and copying).</p>
<p>Most modules can use the built-in <code class="docutils literal notranslate"><span class="pre">AnsibleModule</span></code> methods to manipulate files. To access in a module that needs to know about these special context file systems, instantiate <code class="docutils literal notranslate"><span class="pre">AnsibleModule</span></code> and examine the list in <a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#AnsibleModule._selinux_special_fs" title="AnsibleModule._selinux_special_fs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AnsibleModule._selinux_special_fs</span></code></a>.</p>
<p>This argument replaces <a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#ansible.module_utils.basic.SELINUX_SPECIAL_FS" title="ansible.module_utils.basic.SELINUX_SPECIAL_FS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ansible.module_utils.basic.SELINUX_SPECIAL_FS</span></code></a> from <a class="reference internal" href="#module-replacer"><span class="std std-ref">Module Replacer framework</span></a>.
 In the module replacer framework the argument was formatted as a 
comma-separated string of file system names. Under the Ansiballz 
framework it is a list. You can access <code class="docutils literal notranslate"><span class="pre">_ansible_selinux_special_fs</span></code> using the corresponding environment variable. For more details, see the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#default-selinux-special-fs"><span class="std std-ref">DEFAULT_SELINUX_SPECIAL_FS</span></a> configuration option.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.1.</span></p>
</div>
</section>
<section id="ansible-syslog-facility">
<h4><a class="toc-backref" href="#id26" role="doc-backlink">_ansible_syslog_facility</a><a class="headerlink" href="#ansible-syslog-facility" title="Link to this heading"></a></h4>
<p>This argument controls which syslog facility the module logs to. Most modules should just use the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#AnsibleModule.log" title="AnsibleModule.log"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AnsibleModule.log()</span></code></a> function which will then make use of this. If a module has to use this on its own, it should instantiate the <code class="docutils literal notranslate"><span class="pre">AnsibleModule</span></code> method and then retrieve the name of the syslog facility from <a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#AnsibleModule._syslog_facility" title="AnsibleModule._syslog_facility"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AnsibleModule._syslog_facility</span></code></a>. The Ansiballz code is less elegant than the <a class="reference internal" href="#module-replacer"><span class="std std-ref">Module Replacer framework</span></a> code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell2"><span></span><span class="c1"># Old module_replacer way</span>
<span class="kn">import</span> <span class="nn">syslog</span>
<span class="n">syslog</span><span class="o">.</span><span class="n">openlog</span><span class="p">(</span><span class="n">NAME</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">syslog</span><span class="o">.</span><span class="n">LOG_USER</span><span class="p">)</span>

<span class="c1"># New Ansiballz way</span>
<span class="kn">import</span> <span class="nn">syslog</span>
<span class="n">facility_name</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">_syslog_facility</span>
<span class="n">facility</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">syslog</span><span class="p">,</span> <span class="n">facility_name</span><span class="p">,</span> <span class="n">syslog</span><span class="o">.</span><span class="n">LOG_USER</span><span class="p">)</span>
<span class="n">syslog</span><span class="o">.</span><span class="n">openlog</span><span class="p">(</span><span class="n">NAME</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">facility</span><span class="p">)</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell2">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
<p>For more details, see the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#default-syslog-facility"><span class="std std-ref">DEFAULT_SYSLOG_FACILITY</span></a> configuration option.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.1.</span></p>
</div>
</section>
<section id="ansible-version">
<h4><a class="toc-backref" href="#id27" role="doc-backlink">_ansible_version</a><a class="headerlink" href="#ansible-version" title="Link to this heading"></a></h4>
<p>This argument passes the version of Ansible to the module. To access it, a module should instantiate the <code class="docutils literal notranslate"><span class="pre">AnsibleModule</span></code> method and then retrieve the version from <a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#AnsibleModule.ansible_version" title="AnsibleModule.ansible_version"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AnsibleModule.ansible_version</span></code></a>. This replaces <a class="reference internal" href="https://docs.ansible.com/ansible/latest/api/index.html#ansible.module_utils.basic.ANSIBLE_VERSION" title="ansible.module_utils.basic.ANSIBLE_VERSION"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ansible.module_utils.basic.ANSIBLE_VERSION</span></code></a> from <a class="reference internal" href="#module-replacer"><span class="std std-ref">Module Replacer framework</span></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.1.</span></p>
</div>
</section>
<section id="ansible-module-name">
<h4><a class="toc-backref" href="#id28" role="doc-backlink">_ansible_module_name</a><a class="headerlink" href="#ansible-module-name" title="Link to this heading"></a></h4>
<p>Type: <code class="docutils literal notranslate"><span class="pre">str</span></code></p>
<p>This argument passes the information to modules about their name. For more details see, the configuration option <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#default-module-name"><span class="std std-ref">DEFAULT_MODULE_NAME</span></a>.</p>
</section>
<section id="ansible-string-conversion-action">
<h4><a class="toc-backref" href="#id29" role="doc-backlink">_ansible_string_conversion_action</a><a class="headerlink" href="#ansible-string-conversion-action" title="Link to this heading"></a></h4>
<p>This argument provides instructions about what modules should do 
after the values of the user-specified module parameters are converted 
to strings. For more details, see the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#string-conversion-action"><span class="std std-ref">STRING_CONVERSION_ACTION</span></a> configuration option.</p>
</section>
<section id="ansible-keep-remote-files">
<h4><a class="toc-backref" href="#id30" role="doc-backlink">_ansible_keep_remote_files</a><a class="headerlink" href="#ansible-keep-remote-files" title="Link to this heading"></a></h4>
<p>Type: <code class="docutils literal notranslate"><span class="pre">bool</span></code></p>
<p>This argument provides instructions that modules must be ready if they need to keep the remote files. For more details, see the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#default-keep-remote-files"><span class="std std-ref">DEFAULT_KEEP_REMOTE_FILES</span></a> configuration option.</p>
</section>
<section id="ansible-socket">
<h4><a class="toc-backref" href="#id31" role="doc-backlink">_ansible_socket</a><a class="headerlink" href="#ansible-socket" title="Link to this heading"></a></h4>
<p>This argument provides modules with a socket for persistent connections. The argument is created using the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#persistent-control-path-dir"><span class="std std-ref">PERSISTENT_CONTROL_PATH_DIR</span></a> configuration option.</p>
</section>
<section id="ansible-shell-executable">
<h4><a class="toc-backref" href="#id32" role="doc-backlink">_ansible_shell_executable</a><a class="headerlink" href="#ansible-shell-executable" title="Link to this heading"></a></h4>
<p>Type: <code class="docutils literal notranslate"><span class="pre">bool</span></code></p>
<p>This argument ensures that modules use the designated shell executable. For more details, see the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/inventory_guide/intro_inventory.html#ansible-shell-executable"><span class="std std-ref">ansible_shell_executable</span></a> remote host environment parameter.</p>
</section>
<section id="ansible-tmpdir">
<h4><a class="toc-backref" href="#id33" role="doc-backlink">_ansible_tmpdir</a><a class="headerlink" href="#ansible-tmpdir" title="Link to this heading"></a></h4>
<p>Type: <code class="docutils literal notranslate"><span class="pre">str</span></code></p>
<p>This argument provides instructions to modules that all commands must
 use the designated temporary directory, if created. The action plugin 
designs this temporary directory.</p>
<p>Modules can access this parameter by using the public <code class="docutils literal notranslate"><span class="pre">tmpdir</span></code> property. The <code class="docutils literal notranslate"><span class="pre">tmpdir</span></code> property will create a temporary directory if the action plugin did not set the parameter.</p>
<p>The directory name is generated randomly, and the the root of the directory is determined by one of these:</p>
<ul class="simple">
<li><p><a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#default-local-tmp"><span class="std std-ref">DEFAULT_LOCAL_TMP</span></a></p></li>
<li><p><a class="reference external" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/sh_shell.html#parameter-remote_tmp">remote_tmp</a></p></li>
<li><p><a class="reference external" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/sh_shell.html#parameter-system_tmpdirs">system_tmpdirs</a></p></li>
</ul>
<p>As a result, using the <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code> configuration file to activate or customize this setting will not guarantee that you control the full value.</p>
</section>
<section id="ansible-remote-tmp">
<h4><a class="toc-backref" href="#id34" role="doc-backlink">_ansible_remote_tmp</a><a class="headerlink" href="#ansible-remote-tmp" title="Link to this heading"></a></h4>
<p>The module’s <code class="docutils literal notranslate"><span class="pre">tmpdir</span></code> property creates a randomized directory name in this directory if the action plugin did not set <code class="docutils literal notranslate"><span class="pre">_ansible_tmpdir</span></code>. For more details, see the <a class="reference external" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/sh_shell.html#parameter-remote_tmp">remote_tmp</a> parameter of the shell plugin.</p>
</section>
</section>
<section id="module-return-values-unsafe-strings">
<span id="flow-module-return-values"></span><h3><a class="toc-backref" href="#id35" role="doc-backlink">Module return values &amp; Unsafe strings</a><a class="headerlink" href="#module-return-values-unsafe-strings" title="Link to this heading"></a></h3>
<p>At the end of a module’s execution, it formats the data that it wants
 to return as a JSON string and prints the string to its stdout. The 
normal action plugin receives the JSON string, parses it into a Python 
dictionary, and returns it to the executor.</p>
<p>If Ansible templated every string return value, it would be 
vulnerable to an attack from users with access to managed nodes. If an 
unscrupulous user disguised malicious code as Ansible return value 
strings, and if those strings were then templated on the control node, 
Ansible could execute arbitrary code. To prevent this scenario, Ansible 
marks all strings inside returned data as <code class="docutils literal notranslate"><span class="pre">Unsafe</span></code>, emitting any Jinja2 templates in the strings verbatim, not expanded by Jinja2.</p>
<p>Strings returned by invoking a module through <code class="docutils literal notranslate"><span class="pre">ActionPlugin._execute_module()</span></code> are automatically marked as <code class="docutils literal notranslate"><span class="pre">Unsafe</span></code>
 by the normal action plugin. If another action plugin retrieves 
information from a module through some other means, it must mark its 
return data as <code class="docutils literal notranslate"><span class="pre">Unsafe</span></code> on its own.</p>
<p>In case a poorly-coded action plugin fails to mark its results as 
“Unsafe,” Ansible audits the results again when they are returned to the
 executor,
marking all strings as <code class="docutils literal notranslate"><span class="pre">Unsafe</span></code>.
 The normal action plugin protects itself and any other code that it 
calls with the result data as a parameter. The check inside the executor
 protects the output of all other action plugins, ensuring that 
subsequent tasks run by Ansible will not template anything from those 
results either.</p>
</section>
<section id="special-considerations">
<span id="flow-special-considerations"></span><h3><a class="toc-backref" href="#id36" role="doc-backlink">Special considerations</a><a class="headerlink" href="#special-considerations" title="Link to this heading"></a></h3>
<section id="pipelining">
<span id="flow-pipelining"></span><h4><a class="toc-backref" href="#id37" role="doc-backlink">Pipelining</a><a class="headerlink" href="#pipelining" title="Link to this heading"></a></h4>
<p>Ansible can transfer a module to a remote machine in one of two ways:</p>
<ul class="simple">
<li><p>it can write out the module to a temporary file on the remote host and then
use a second connection to the remote host to execute it with the
interpreter that the module needs</p></li>
<li><p>or it can use what’s known as pipelining to execute the module by piping it
into the remote interpreter’s stdin.</p></li>
</ul>
<p>Pipelining only works with modules written in Python at this time because
Ansible only knows that Python supports this mode of operation. Supporting
pipelining means that whatever format the module payload takes before being
sent over the wire must be executable by Python through stdin.</p>
</section>
<section id="why-pass-args-over-stdin">
<span id="flow-args-over-stdin"></span><h4><a class="toc-backref" href="#id38" role="doc-backlink">Why pass args over stdin?</a><a class="headerlink" href="#why-pass-args-over-stdin" title="Link to this heading"></a></h4>
<p>Passing arguments through stdin was chosen for the following reasons:</p>
<ul class="simple">
<li><p>When combined with <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#ansible-pipelining"><span class="std std-ref">ANSIBLE_PIPELINING</span></a>, this keeps the module’s arguments from
temporarily being saved onto disk on the remote machine. This makes it
harder (but not impossible) for a malicious user on the remote machine to
steal any sensitive information that may be present in the arguments.</p></li>
<li><p>Command line arguments would be insecure as most systems allow unprivileged
users to read the full commandline of a process.</p></li>
<li><p>Environment variables are usually more secure than the commandline but some
systems limit the total size of the environment. This could lead to
truncation of the parameters if we hit that limit.</p></li>
</ul>
</section>
</section>
<section id="ansiblemodule">
<span id="flow-ansiblemodule"></span><h3><a class="toc-backref" href="#id39" role="doc-backlink">AnsibleModule</a><a class="headerlink" href="#ansiblemodule" title="Link to this heading"></a></h3>
<section id="argument-spec">
<span id="id2"></span><h4><a class="toc-backref" href="#id40" role="doc-backlink">Argument spec</a><a class="headerlink" href="#argument-spec" title="Link to this heading"></a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">argument_spec</span></code> provided to <code class="docutils literal notranslate"><span class="pre">AnsibleModule</span></code> defines the supported arguments for a module, as well as their type, defaults and more.</p>
<p>Example <code class="docutils literal notranslate"><span class="pre">argument_spec</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell3"><span></span><span class="n">module</span> <span class="o">=</span> <span class="n">AnsibleModule</span><span class="p">(</span><span class="n">argument_spec</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">top_level</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="nb">type</span><span class="o">=</span><span class="s1">'dict'</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">second_level</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">'bool'</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">))</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell3">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
<p>This section will discuss the behavioral attributes for arguments:</p>
<dl class="field-list">
<dt class="field-odd">type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">type</span></code> allows you to define the type of the value accepted for the argument. The default value for <code class="docutils literal notranslate"><span class="pre">type</span></code> is <code class="docutils literal notranslate"><span class="pre">str</span></code>. Possible values are:</p>
<ul class="simple">
<li><p>str</p></li>
<li><p>list</p></li>
<li><p>dict</p></li>
<li><p>bool</p></li>
<li><p>int</p></li>
<li><p>float</p></li>
<li><p>path</p></li>
<li><p>raw</p></li>
<li><p>jsonarg</p></li>
<li><p>json</p></li>
<li><p>bytes</p></li>
<li><p>bits</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">raw</span></code> type, performs no type validation or type casting, and maintains the type of the passed value.</p>
</dd>
<dt class="field-even">elements<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">elements</span></code> works in combination with <code class="docutils literal notranslate"><span class="pre">type</span></code> when <code class="docutils literal notranslate"><span class="pre">type='list'</span></code>. <code class="docutils literal notranslate"><span class="pre">elements</span></code> can then be defined as <code class="docutils literal notranslate"><span class="pre">elements='int'</span></code> or any other type, indicating that each element of the specified list should be of that type.</p>
</dd>
<dt class="field-odd">default<span class="colon">:</span></dt>
<dd class="field-odd"><p>The <code class="docutils literal notranslate"><span class="pre">default</span></code>
 option allows sets a default value for the argument for the scenario 
when the argument is not provided to the module. When not specified, the
 default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-even">fallback<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">fallback</span></code> accepts a <code class="docutils literal notranslate"><span class="pre">tuple</span></code>
 where the first argument is a callable (function) that will be used to 
perform the lookup, based on the second argument. The second argument is
 a list of values to be accepted by the callable.</p>
<p>The most common callable used is <code class="docutils literal notranslate"><span class="pre">env_fallback</span></code> which will allow an argument to optionally use an environment variable when the argument is not supplied.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell4"><span></span><span class="n">username</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fallback</span><span class="o">=</span><span class="p">(</span><span class="n">env_fallback</span><span class="p">,</span> <span class="p">[</span><span class="s1">'ANSIBLE_NET_USERNAME'</span><span class="p">]))</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell4">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
</dd>
<dt class="field-odd">choices<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">choices</span></code> accepts a list of choices that the argument will accept. The types of <code class="docutils literal notranslate"><span class="pre">choices</span></code> should match the <code class="docutils literal notranslate"><span class="pre">type</span></code>.</p>
</dd>
<dt class="field-even">required<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">required</span></code> accepts a boolean, either <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> that indicates that the argument is required. When not specified, <code class="docutils literal notranslate"><span class="pre">required</span></code> defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>. This should not be used in combination with <code class="docutils literal notranslate"><span class="pre">default</span></code>.</p>
</dd>
<dt class="field-odd">no_log<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">no_log</span></code> accepts a boolean, either <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>, that indicates explicitly whether or not the argument value should be masked in logs and output.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the absence of <code class="docutils literal notranslate"><span class="pre">no_log</span></code>,
 if the parameter name appears to indicate that the argument value is a 
password or passphrase (such as “admin_password”), a warning will be 
shown and the value will be masked in logs but <strong>not</strong> output. To disable the warning and masking for parameters that do not contain sensitive information, set <code class="docutils literal notranslate"><span class="pre">no_log</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</div>
</dd>
<dt class="field-even">aliases<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">aliases</span></code> accepts a list of alternative argument names for the argument, such as the case where the argument is <code class="docutils literal notranslate"><span class="pre">name</span></code> but the module accepts <code class="docutils literal notranslate"><span class="pre">aliases=['pkg']</span></code> to allow <code class="docutils literal notranslate"><span class="pre">pkg</span></code> to be interchangeably with <code class="docutils literal notranslate"><span class="pre">name</span></code>.
 Use of aliases can make module interfaces confusing, so we recommend 
adding them only when necessary. If you are updating argument names to 
fix a typo or improve the interface, consider moving the old names to <code class="docutils literal notranslate"><span class="pre">deprecated_aliases</span></code> rather than keeping them around indefinitely.</p>
</dd>
<dt class="field-odd">options<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">options</span></code>
 implements the ability to create a sub-argument_spec, where the sub 
options of the top level argument are also validated using the 
attributes discussed in this section. The example at the top of this 
section demonstrates use of <code class="docutils literal notranslate"><span class="pre">options</span></code>. <code class="docutils literal notranslate"><span class="pre">type</span></code> or <code class="docutils literal notranslate"><span class="pre">elements</span></code> should be <code class="docutils literal notranslate"><span class="pre">dict</span></code> is this case.</p>
</dd>
<dt class="field-even">apply_defaults<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">apply_defaults</span></code> works alongside <code class="docutils literal notranslate"><span class="pre">options</span></code> and allows the <code class="docutils literal notranslate"><span class="pre">default</span></code> of the sub-options to be applied even when the top-level argument is not supplied.</p>
<p>In the example of the <code class="docutils literal notranslate"><span class="pre">argument_spec</span></code> at the top of this section, it would allow <code class="docutils literal notranslate"><span class="pre">module.params['top_level']['second_level']</span></code> to be defined, even if the user does not provide <code class="docutils literal notranslate"><span class="pre">top_level</span></code> when calling the module.</p>
</dd>
<dt class="field-odd">removed_in_version<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">removed_in_version</span></code> indicates which version of ansible-core or a collection a deprecated argument will be removed in. Mutually exclusive with <code class="docutils literal notranslate"><span class="pre">removed_at_date</span></code>, and must be used with <code class="docutils literal notranslate"><span class="pre">removed_from_collection</span></code>.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell5"><span></span><span class="n">option</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'type'</span><span class="p">:</span> <span class="s1">'str'</span><span class="p">,</span>
  <span class="s1">'removed_in_version'</span><span class="p">:</span> <span class="s1">'2.0.0'</span><span class="p">,</span>
  <span class="s1">'removed_from_collection'</span><span class="p">:</span> <span class="s1">'testns.testcol'</span><span class="p">,</span>
<span class="p">},</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell5">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
</dd>
<dt class="field-even">removed_at_date<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">removed_at_date</span></code>
 indicates that a deprecated argument will be removed in a minor 
ansible-core release or major collection release after this date. 
Mutually exclusive with <code class="docutils literal notranslate"><span class="pre">removed_in_version</span></code>, and must be used with <code class="docutils literal notranslate"><span class="pre">removed_from_collection</span></code>.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell6"><span></span><span class="n">option</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'type'</span><span class="p">:</span> <span class="s1">'str'</span><span class="p">,</span>
  <span class="s1">'removed_at_date'</span><span class="p">:</span> <span class="s1">'2020-12-31'</span><span class="p">,</span>
  <span class="s1">'removed_from_collection'</span><span class="p">:</span> <span class="s1">'testns.testcol'</span><span class="p">,</span>
<span class="p">},</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell6">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
</dd>
<dt class="field-odd">removed_from_collection<span class="colon">:</span></dt>
<dd class="field-odd"><p>Specifies which collection (or ansible-core) deprecates this deprecated argument. Specify <code class="docutils literal notranslate"><span class="pre">ansible.builtin</span></code> for ansible-core, or the collection’s name (format <code class="docutils literal notranslate"><span class="pre">foo.bar</span></code>). Must be used with <code class="docutils literal notranslate"><span class="pre">removed_in_version</span></code> or <code class="docutils literal notranslate"><span class="pre">removed_at_date</span></code>.</p>
</dd>
<dt class="field-even">deprecated_aliases<span class="colon">:</span></dt>
<dd class="field-even"><p>Deprecates aliases of this argument. Must contain a list or tuple of dictionaries having some the following keys:</p>
<dl class="field-list simple">
<dt class="field-odd">name<span class="colon">:</span></dt>
<dd class="field-odd"><p>The name of the alias to deprecate. (Required.)</p>
</dd>
<dt class="field-even">version<span class="colon">:</span></dt>
<dd class="field-even"><p>The version of ansible-core or the collection this alias will be removed in. Either <code class="docutils literal notranslate"><span class="pre">version</span></code> or <code class="docutils literal notranslate"><span class="pre">date</span></code> must be specified.</p>
</dd>
<dt class="field-odd">date<span class="colon">:</span></dt>
<dd class="field-odd"><p>The a date after which a minor release of ansible-core or a major collection release will no longer contain this alias.. Either <code class="docutils literal notranslate"><span class="pre">version</span></code> or <code class="docutils literal notranslate"><span class="pre">date</span></code> must be specified.</p>
</dd>
<dt class="field-even">collection_name<span class="colon">:</span></dt>
<dd class="field-even"><p>Specifies which collection (or ansible-core) deprecates this deprecated alias. Specify <code class="docutils literal notranslate"><span class="pre">ansible.builtin</span></code> for ansible-core, or the collection’s name (format <code class="docutils literal notranslate"><span class="pre">foo.bar</span></code>). Must be used with <code class="docutils literal notranslate"><span class="pre">version</span></code> or <code class="docutils literal notranslate"><span class="pre">date</span></code>.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell7"><span></span><span class="n">option</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'type'</span><span class="p">:</span> <span class="s1">'str'</span><span class="p">,</span>
  <span class="s1">'aliases'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'foo'</span><span class="p">,</span> <span class="s1">'bar'</span><span class="p">],</span>
  <span class="s1">'deprecated_aliases'</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s1">'name'</span><span class="p">:</span> <span class="s1">'foo'</span><span class="p">,</span>
      <span class="s1">'version'</span><span class="p">:</span> <span class="s1">'2.0.0'</span><span class="p">,</span>
      <span class="s1">'collection_name'</span><span class="p">:</span> <span class="s1">'testns.testcol'</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s1">'name'</span><span class="p">:</span> <span class="s1">'foo'</span><span class="p">,</span>
      <span class="s1">'date'</span><span class="p">:</span> <span class="s1">'2020-12-31'</span><span class="p">,</span>
      <span class="s1">'collection_name'</span><span class="p">:</span> <span class="s1">'testns.testcol'</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">],</span>
<span class="p">},</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell7">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
</dd>
<dt class="field-odd">mutually_exclusive<span class="colon">:</span></dt>
<dd class="field-odd"><p>If <code class="docutils literal notranslate"><span class="pre">options</span></code> is specified, <code class="docutils literal notranslate"><span class="pre">mutually_exclusive</span></code> refers to the sub-options described in <code class="docutils literal notranslate"><span class="pre">options</span></code> and behaves as in <a class="reference internal" href="#argument-spec-dependencies"><span class="std std-ref">Dependencies between module options</span></a>.</p>
</dd>
<dt class="field-even">required_together<span class="colon">:</span></dt>
<dd class="field-even"><p>If <code class="docutils literal notranslate"><span class="pre">options</span></code> is specified, <code class="docutils literal notranslate"><span class="pre">required_together</span></code> refers to the sub-options described in <code class="docutils literal notranslate"><span class="pre">options</span></code> and behaves as in <a class="reference internal" href="#argument-spec-dependencies"><span class="std std-ref">Dependencies between module options</span></a>.</p>
</dd>
<dt class="field-odd">required_one_of<span class="colon">:</span></dt>
<dd class="field-odd"><p>If <code class="docutils literal notranslate"><span class="pre">options</span></code> is specified, <code class="docutils literal notranslate"><span class="pre">required_one_of</span></code> refers to the sub-options described in <code class="docutils literal notranslate"><span class="pre">options</span></code> and behaves as in <a class="reference internal" href="#argument-spec-dependencies"><span class="std std-ref">Dependencies between module options</span></a>.</p>
</dd>
<dt class="field-even">required_if<span class="colon">:</span></dt>
<dd class="field-even"><p>If <code class="docutils literal notranslate"><span class="pre">options</span></code> is specified, <code class="docutils literal notranslate"><span class="pre">required_if</span></code> refers to the sub-options described in <code class="docutils literal notranslate"><span class="pre">options</span></code> and behaves as in <a class="reference internal" href="#argument-spec-dependencies"><span class="std std-ref">Dependencies between module options</span></a>.</p>
</dd>
<dt class="field-odd">required_by<span class="colon">:</span></dt>
<dd class="field-odd"><p>If <code class="docutils literal notranslate"><span class="pre">options</span></code> is specified, <code class="docutils literal notranslate"><span class="pre">required_by</span></code> refers to the sub-options described in <code class="docutils literal notranslate"><span class="pre">options</span></code> and behaves as in <a class="reference internal" href="#argument-spec-dependencies"><span class="std std-ref">Dependencies between module options</span></a>.</p>
</dd>
<dt class="field-even">context<span class="colon">:</span></dt>
<dd class="field-even"><div class="versionadded">
<p><span class="versionmodified added">New in version 2.17.</span></p>
</div>
<p>You can set the value of the <code class="docutils literal notranslate"><span class="pre">context</span></code>
 key to a dict of custom content. This allows you to provide additional 
context in the argument spec. The content provided is not validated or 
utilized by the core engine.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell8"><span></span><span class="n">option</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'type'</span><span class="p">:</span> <span class="s1">'str'</span><span class="p">,</span>
    <span class="s1">'context'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">'disposition'</span><span class="p">:</span> <span class="s1">'/properties/apiType'</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">'choices'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'http'</span><span class="p">,</span> <span class="s1">'soap'</span><span class="p">],</span>
<span class="p">}</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell8">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
</dd>
</dl>
</section>
<section id="dependencies-between-module-options">
<span id="argument-spec-dependencies"></span><h4><a class="toc-backref" href="#id41" role="doc-backlink">Dependencies between module options</a><a class="headerlink" href="#dependencies-between-module-options" title="Link to this heading"></a></h4>
<p>The following are optional arguments for <code class="docutils literal notranslate"><span class="pre">AnsibleModule()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell9"><span></span><span class="n">module</span> <span class="o">=</span> <span class="n">AnsibleModule</span><span class="p">(</span>
  <span class="n">argument_spec</span><span class="p">,</span>
  <span class="n">mutually_exclusive</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="s1">'content'</span><span class="p">),</span>
  <span class="p">],</span>
  <span class="n">required_one_of</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="s1">'content'</span><span class="p">),</span>
  <span class="p">],</span>
<span class="p">)</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell9">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
<dl class="field-list">
<dt class="field-odd">mutually_exclusive<span class="colon">:</span></dt>
<dd class="field-odd"><p>Must be a sequence (list or tuple) of sequences
 of strings. Every sequence of strings is a list of option names which 
are mutually exclusive. If more than one options of a list are specified
 together, Ansible will fail the module with an error.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell10"><span></span><span class="n">mutually_exclusive</span><span class="o">=</span><span class="p">[</span>
  <span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="s1">'content'</span><span class="p">),</span>
  <span class="p">(</span><span class="s1">'repository_url'</span><span class="p">,</span> <span class="s1">'repository_filename'</span><span class="p">),</span>
<span class="p">],</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell10">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
<p>In this example, the options <code class="docutils literal notranslate"><span class="pre">path</span></code> and <code class="docutils literal notranslate"><span class="pre">content</span></code> must not specified at the same time. Also the options <code class="docutils literal notranslate"><span class="pre">repository_url</span></code> and <code class="docutils literal notranslate"><span class="pre">repository_filename</span></code> must not be specified at the same time. But specifying <code class="docutils literal notranslate"><span class="pre">path</span></code> and <code class="docutils literal notranslate"><span class="pre">repository_url</span></code> is accepted.</p>
<p>To ensure that precisely one of two (or more) options is specified, combine <code class="docutils literal notranslate"><span class="pre">mutually_exclusive</span></code> with <code class="docutils literal notranslate"><span class="pre">required_one_of</span></code>.</p>
</dd>
<dt class="field-even">required_together<span class="colon">:</span></dt>
<dd class="field-even"><p>Must be a sequence (list or tuple) of 
sequences of strings. Every sequence of strings is a list of option 
names which are must be specified together. If at least one of these 
options are specified, the other ones from the same sequence must all be
 present.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell11"><span></span><span class="n">required_together</span><span class="o">=</span><span class="p">[</span>
  <span class="p">(</span><span class="s1">'file_path'</span><span class="p">,</span> <span class="s1">'file_hash'</span><span class="p">),</span>
<span class="p">],</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell11">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
<p>In this example, if one of the options <code class="docutils literal notranslate"><span class="pre">file_path</span></code> or <code class="docutils literal notranslate"><span class="pre">file_hash</span></code> is specified, Ansible will fail the module with an error if the other one is not specified.</p>
</dd>
<dt class="field-odd">required_one_of<span class="colon">:</span></dt>
<dd class="field-odd"><p>Must be a sequence (list or tuple) of sequences
 of strings. Every sequence of strings is a list of option names from 
which at least one must be specified. If none one of these options are 
specified, Ansible will fail module execution.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell12"><span></span><span class="n">required_one_of</span><span class="o">=</span><span class="p">[</span>
  <span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="s1">'content'</span><span class="p">),</span>
<span class="p">],</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell12">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
<p>In this example, at least one of <code class="docutils literal notranslate"><span class="pre">path</span></code> and <code class="docutils literal notranslate"><span class="pre">content</span></code> must be specified. If none are specified, execution will fail. Specifying both is explicitly allowed; to prevent this, combine <code class="docutils literal notranslate"><span class="pre">required_one_of</span></code> with <code class="docutils literal notranslate"><span class="pre">mutually_exclusive</span></code>.</p>
</dd>
<dt class="field-even">required_if<span class="colon">:</span></dt>
<dd class="field-even"><p>Must be a sequence of sequences. Every inner 
sequence describes one conditional dependency. Every sequence must have 
three or four values. The first two values are the option’s name and the
 option’s value which describes the condition. The further elements of 
the sequence are only needed if the option of that name has precisely 
this value.</p>
<p>If you want that all options in a list of option names are specified if the condition is met, use one of the following forms:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell13"><span></span><span class="p">(</span><span class="s1">'option_name'</span><span class="p">,</span> <span class="n">option_value</span><span class="p">,</span> <span class="p">(</span><span class="s1">'option_a'</span><span class="p">,</span> <span class="s1">'option_b'</span><span class="p">,</span> <span class="o">...</span><span class="p">)),</span>
<span class="p">(</span><span class="s1">'option_name'</span><span class="p">,</span> <span class="n">option_value</span><span class="p">,</span> <span class="p">(</span><span class="s1">'option_a'</span><span class="p">,</span> <span class="s1">'option_b'</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span> <span class="kc">False</span><span class="p">),</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell13">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
<p>If you want that at least one option of a list of option names is specified if the condition is met, use the following form:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell14"><span></span><span class="p">(</span><span class="s1">'option_name'</span><span class="p">,</span> <span class="n">option_value</span><span class="p">,</span> <span class="p">(</span><span class="s1">'option_a'</span><span class="p">,</span> <span class="s1">'option_b'</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span> <span class="kc">True</span><span class="p">),</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell14">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell15"><span></span><span class="n">required_if</span><span class="o">=</span><span class="p">[</span>
  <span class="p">(</span><span class="s1">'state'</span><span class="p">,</span> <span class="s1">'present'</span><span class="p">,</span> <span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="s1">'content'</span><span class="p">),</span> <span class="kc">True</span><span class="p">),</span>
  <span class="p">(</span><span class="s1">'force'</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="p">(</span><span class="s1">'force_reason'</span><span class="p">,</span> <span class="s1">'force_code'</span><span class="p">)),</span>
<span class="p">],</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell15">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
<p>In this example, if the user specifies <code class="docutils literal notranslate"><span class="pre">state=present</span></code>, at least one of the options <code class="docutils literal notranslate"><span class="pre">path</span></code> and <code class="docutils literal notranslate"><span class="pre">content</span></code> must be supplied (or both). To make sure that precisely one can be specified, combine <code class="docutils literal notranslate"><span class="pre">required_if</span></code> with <code class="docutils literal notranslate"><span class="pre">mutually_exclusive</span></code>.</p>
<p>On the other hand, if <code class="docutils literal notranslate"><span class="pre">force</span></code> (a boolean parameter) is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, <code class="docutils literal notranslate"><span class="pre">yes</span></code> and so on, both <code class="docutils literal notranslate"><span class="pre">force_reason</span></code> and <code class="docutils literal notranslate"><span class="pre">force_code</span></code> must be specified.</p>
</dd>
<dt class="field-odd">required_by<span class="colon">:</span></dt>
<dd class="field-odd"><p>Must be a dictionary mapping option names to 
sequences of option names. If the option name in a dictionary key is 
specified, the option names it maps to must all also be specified. Note 
that instead of a sequence of option names, you can also specify one 
single option name.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell16"><span></span><span class="n">required_by</span><span class="o">=</span><span class="p">{</span>
  <span class="s1">'force'</span><span class="p">:</span> <span class="s1">'force_reason'</span><span class="p">,</span>
  <span class="s1">'path'</span><span class="p">:</span> <span class="p">(</span><span class="s1">'mode'</span><span class="p">,</span> <span class="s1">'owner'</span><span class="p">,</span> <span class="s1">'group'</span><span class="p">),</span>
<span class="p">},</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell16">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
<p>In the example, if <code class="docutils literal notranslate"><span class="pre">force</span></code> is specified, <code class="docutils literal notranslate"><span class="pre">force_reason</span></code> must also be specified. Also, if <code class="docutils literal notranslate"><span class="pre">path</span></code> is specified, then three three options <code class="docutils literal notranslate"><span class="pre">mode</span></code>, <code class="docutils literal notranslate"><span class="pre">owner</span></code> and <code class="docutils literal notranslate"><span class="pre">group</span></code> also must be specified.</p>
</dd>
</dl>
</section>
<section id="declaring-check-mode-support">
<h4><a class="toc-backref" href="#id42" role="doc-backlink">Declaring check mode support</a><a class="headerlink" href="#declaring-check-mode-support" title="Link to this heading"></a></h4>
<p>To declare that a module supports check mode, supply <code class="docutils literal notranslate"><span class="pre">supports_check_mode=True</span></code> to the <code class="docutils literal notranslate"><span class="pre">AnsibleModule()</span></code> call:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell17"><span></span><span class="n">module</span> <span class="o">=</span> <span class="n">AnsibleModule</span><span class="p">(</span><span class="n">argument_spec</span><span class="p">,</span> <span class="n">supports_check_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell17">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
<p>The module can determine whether it is called in check mode by checking the boolean value <code class="docutils literal notranslate"><span class="pre">module.check_mode</span></code>. If it evaluates to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the module must take care not to do any modification.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">supports_check_mode=False</span></code> is specified, which is the default value, the module will exit in check mode with <code class="docutils literal notranslate"><span class="pre">skipped=True</span></code> and message <code class="docutils literal notranslate"><span class="pre">remote</span> <span class="pre">module</span> <span class="pre">(&lt;insert</span> <span class="pre">module</span> <span class="pre">name</span> <span class="pre">here&gt;)</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">support</span> <span class="pre">check</span> <span class="pre">mode</span></code>.</p>
</section>
<section id="adding-file-options">
<h4><a class="toc-backref" href="#id43" role="doc-backlink">Adding file options</a><a class="headerlink" href="#adding-file-options" title="Link to this heading"></a></h4>
<p>To declare that a module should add support for all common file options, supply <code class="docutils literal notranslate"><span class="pre">add_file_common_args=True</span></code> to the <code class="docutils literal notranslate"><span class="pre">AnsibleModule()</span></code> call:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell18"><span></span><span class="n">module</span> <span class="o">=</span> <span class="n">AnsibleModule</span><span class="p">(</span><span class="n">argument_spec</span><span class="p">,</span> <span class="n">add_file_common_args</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell18">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
<p>You can find <a class="reference external" href="https://github.com/ansible/ansible/blob/devel/lib/ansible/plugins/doc_fragments/files.py">a list of all file options here</a>. It is recommended that you make your <code class="docutils literal notranslate"><span class="pre">DOCUMENTATION</span></code> extend the doc fragment <code class="docutils literal notranslate"><span class="pre">ansible.builtin.files</span></code> (see <a class="reference internal" href="https://docs.ansible.com/ansible/latest/dev_guide/developing_modules_documenting.html#module-docs-fragments"><span class="std std-ref">Documentation fragments</span></a>) in this case, to make sure that all these fields are correctly documented.</p>
<p>The helper functions <code class="docutils literal notranslate"><span class="pre">module.load_file_common_arguments()</span></code> and <code class="docutils literal notranslate"><span class="pre">module.set_fs_attributes_if_different()</span></code> can be used to handle these arguments for you:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre id="codecell19"><span></span><span class="n">argument_spec</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'path'</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'type'</span><span class="p">:</span> <span class="s1">'str'</span><span class="p">,</span>
    <span class="s1">'required'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">}</span>

<span class="n">module</span> <span class="o">=</span> <span class="n">AnsibleModule</span><span class="p">(</span><span class="n">argument_spec</span><span class="p">,</span> <span class="n">add_file_common_args</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">changed</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># TODO do something with module.params['path'], like update its contents</span>

<span class="c1"># Ensure that module.params['path'] satisfies the file options supplied by the user</span>
<span class="n">file_args</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">load_file_common_arguments</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
<span class="n">changed</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">set_fs_attributes_if_different</span><span class="p">(</span><span class="n">file_args</span><span class="p">,</span> <span class="n">changed</span><span class="p">)</span>

<span class="n">module</span><span class="o">.</span><span class="n">exit_json</span><span class="p">(</span><span class="n">changed</span><span class="o">=</span><span class="n">changed</span><span class="p">)</span>
</pre><button class="copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#codecell19">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <title>Copy to clipboard</title>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <rect x="8" y="8" width="12" height="12" rx="2"></rect>
  <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
</svg>
    </button></div>
</div>
</section>
</section>
</section>
</section>


           </div>
          </div>
          

<footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="https://docs.ansible.com/ansible/latest/dev_guide/core_branches_and_tags.html" class="btn btn-neutral float-left" title="ansible-core project branches and tags" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="https://docs.ansible.com/ansible/latest/dev_guide/developing_api.html" class="btn btn-neutral float-right" title="Python API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr>

  <div role="contentinfo">
    <p>© Copyright Ansible project contributors.
      <span class="lastupdated">Last updated on Aug 29, 2024.
      </span></p>
  </div>

  
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script><!-- extra footer elements for Ansible beyond RTD Sphinx Theme -->
<!-- begin analytics -->
<script>
var _hsq = _hsq || [];
_hsq.push(["setContentType", "standard-page"]);
      (function(d,s,i,r) {
      if (d.getElementById(i)){return;}
      var n = d.createElement(s),e = document.getElementsByTagName(s)[0];
      n.id=i;n.src = 'https://js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/330046.js';
      e.parentNode.insertBefore(n, e);
      })(document, "script", "hs-analytics",300000);
</script>
<!-- end analytics -->
<script>
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
  _satellite.pageBottom();
}
</script>


<script>_satellite["_runScript1"](function(event, target, Promise) {
if(void 0!==_sdi.util){var pageHeight=document.body.scrollHeight,viewportHeight=window.innerHeight,initialPercent=viewportHeight/pageHeight,maxInterval=0;initialPercent=initialPercent>1?100:Math.round(100*initialPercent);var maxScroll=Math.floor(initialPercent);window._sdi.util.setCookie("sat_ppv",maxScroll),window.onscroll=function(){var i=window.pageYOffset/(document.body.scrollHeight-window.innerHeight)*100;i>maxScroll&&(maxScroll=Math.floor(i)),window._sdi.util.setCookie("sat_ppv",maxScroll)}}
});</script><script>_satellite["_runScript2"](function(event, target, Promise) {
void 0!==_sdi.util&&(window._sdi=window._sdi||{},window._sdi.addEventHandler=window.addEventListener?function(e,t,i){e.addEventListener(t,i,!1)}:function(e,t,i){e.attachEvent("on"+t,i)},window._sdi.addEventHandler(window,"message",(function(e){var t={},i=0;(-1!==e.origin.indexOf("loop=1")||e.srcElement&&e.srcElement.playerOptions&&1==e.srcElement.playerOptions.loop)&&(i=1);var a=0;if(e.srcElement&&e.srcElement.playerOptions&&1==e.srcElement.playerOptions.autoplay&&(a=1),e.origin.match(/youtube\.com/)&&"undefined"!=typeof JSON&&!i&&!a){t=JSON.parse(e.data);var d=window._sdi.yt.videos;if("infoDelivery"==t.event){var o,n={};for(var s in t.info.videoData&&((n=d[o=t.info.videoData.video_id]||{}).info=t.info,n.id=t.id,d[o]=n),window._sdi.yt.videos){(c=window._sdi.yt.videos[s]).id==t.id&&(n=c)}var r=window._sdi.yt.sc||{};n.info&&(Math.abs(t.info.currentTime-n.info.currentTime)>1.5&&!0===r.track&&(r.s().Media.stop(n.info.videoData.title,n.info.currentTime),"paused"!=n.state&&r.s().Media.play(n.info.videoData.title,t.info.currentTime)),n.info.currentTime=t.info.currentTime),2==t.info.playerState&&(r.s().Media.stop(n.info.videoData.title,n.info.currentTime),n.state="paused"),1==t.info.playerState&&(n.started?!0===r.track&&r.s().Media.play(n.info.videoData.title,n.info.currentTime):(n.started=!0,!0===r.track&&(r.s().Media.open(n.info.videoData.title,n.info.duration,"youtube"),r.s().Media.play(n.info.videoData.title,n.info.currentTime))),n.state="playing"),3==t.info.playerState&&n.started&&(!0===r.track&&r.s().Media.stop(n.info.videoData.title,n.info.currentTime),n.state="paused"),0===t.info.playerState&&(!0===r.track&&(r.s().Media.stop(n.info.videoData.title,n.info.currentTime),r.s().Media.close(n.info.videoData.title)),n.state="completed")}else if("onStateChange"==t.event){for(var s in window._sdi.yt.videos){var c;(c=window._sdi.yt.videos[s]).id==t.id&&(n=c)}r=window._sdi.yt.sc||{};1==t.info&&(n.started?!0===r.track&&r.s().Media.play(n.info.videoData.title,n.info.currentTime):(n.started=!0,!0===r.track&&(r.s().Media.open(n.info.videoData.title,n.info.duration,"youtube"),"paused"!=n.state&&r.s().Media.play(n.info.videoData.title,t.info.currentTime))),n.state="playing"),2==t.info&&(!0===r.track&&r.s().Media.stop(n.info.videoData.title,n.info.currentTime),n.state="paused"),3==t.info&&n.started&&(!0===r.track&&r.s().Media.stop(n.info.videoData.title,n.info.currentTime),n.state="paused"),0===t.info&&(!0===r.track&&(r.s().Media.stop(n.info.videoData.title,n.info.currentTime),r.s().Media.close(n.info.videoData.title)),n.state="completed")}}})),window._sdi.loadScript=function(e,t){var i=document.createElement("script");i.type="text/javascript",t&&"function"==typeof t&&(i.readyState?i.onreadystatechange=function(){"loaded"!==i.readyState&&"complete"!==i.readyState||(i.onreadystatechange=null,t())}:i.onload=function(){t()}),i.src=e,document.getElementsByTagName("head")[0].appendChild(i)},window._sdi.yt={stages:{},players:{},sc:{track:!0,s:function(){return s_gi(_satellite.getVar("rsid"))}},init:function(){for(var e=document.getElementsByTagName("script"),t=!1,i=(window._sdi.yt.videos,0);i<e.length;i++){(e[i].src||"").match(/youtube\.com\/iframe_api/)&&(t=!0)}!1===t?window._sdi.loadScript("//www.youtube.com/iframe_api",(function(){window._sdi.yt.ready("api")})):window._sdi.yt.ready("api")},ready:function(e){window._sdi.yt.stages[e]=!0,window._sdi.yt.stages.dom&&window._sdi.yt.stages.api&&window._sdi.yt.checkIframes()},checkIframes:function(){var e=window._sdi.yt.videos,t=1e3,i=0;document.querySelectorAll('iframe[src*="youtube"]').forEach((function(a){if("true"!=a.dataset.sdiyt){if(-1!=a.src.indexOf("loop=1"))var d=null;else{var o;d=a.src.match(/h?t?t?p?s?\:?\/\/www\.youtube(-nocookie)?\.com\/embed\/([\w-]{11})(?:\?.*)?/)}if(d){o=d.length>2?d[2]:"",a.id||(a.id=o+i,i++);var n=!1;if(!a.src.match(/origin/)&&document.location.protocol,a.src.match(/enablejsapi=1/)||(a.src+=(a.src.indexOf("?")>-1?"&":"?")+"enablejsapi=1",n=!0),void 0!==_sdi.util&&n){var s=this.cloneNode(!0);s.src=a.src,s.id=a.id,this.replaceWith(s)}else"undefined"!=typeof YT&&void 0!==YT.get?(ready=!0,e[o]={},!YT.get(a.id)||void 0===YT.get(a.id).v&&void 0!==YT.get(a.id).v.videoId?(e[o].player=new YT.Player(a.id,{events:{onReady:function(){},onStateChange:function(){},videoId:a.id}}),"true"!==a.getAttribute("data-sdiyt")&&a.setAttribute("data-sdiyt","true")):"true"!==a.getAttribute("data-sdiyt")&&a.setAttribute("data-sdiyt","true")):t=100}}})),setTimeout((function(){window._sdi.yt.checkIframes()}),t)},videos:{}},void 0!==window._sdi&&void 0!==window._sdi.addEventHandler&&window._sdi.addEventHandler(window,"load",(function(){document.querySelectorAll('iframe[src*="youtube"]').length>=1?(window._sdi.yt.init(),window._sdi.yt.ready("dom")):window._sdi.ytinterval=setInterval((function(){document.querySelectorAll('iframe[src*="youtube"]').length>=1&&(window._sdi.yt.init(),window._sdi.yt.ready("dom"),clearInterval(window._sdi.ytinterval))}),500)})));
});</script><script>_satellite["_runScript3"](function(event, target, Promise) {
window._sdi=window._sdi||{},window._sdi.dtm=window._sdi.dtm||{},window._sdi.dtm.video=window._sdi.dtm.video||{},_sdi.dtm.video.wistia={sc:{track:!0,s:function(){if(_sdi.util.getVar("window.s_gi")){if(void 0!==_satellite.getVar("rsid"))return s_gi(_satellite.getVar("rsid"));_satellite.logger.log("WISTIA Tracking:No RSID for s.Media: Wistia Tracking",5)}}},vids:[],timesPolled:0,pollToBind:function(){_satellite.logger.log("WISTIA Tracking: Polling for remaing video binding"),_sdi.dtm.video.wistia.timesPolled<30&&setTimeout((function(){_sdi.dtm.video.wistia.timesPolled++,_sdi.dtm.video.wistia.bindEvents()}),1e3)},bindEvents:function(){ws=_sdi.dtm.video.wistia,sc=ws.sc,s=sc.s,poll=!1,s().Media.playerName="wistia",s().Media.autoTrack=!1;for(var i=0;i<_sdi.dtm.video.wistia.vids.length;i++){var e=_sdi.dtm.video.wistia.vids[i],d=e.name(),t=e.duration();""!=d?void 0===e.adobeAnalyicsTrackingApplied?(_satellite.logger.log("WISTIA Tracking: Binding liteners to Wistia video named: "+d),void 0!==s()&&void 0!==s().Media&&(!0===sc.track&&(_satellite.logger.log("WISTIA Tracking: the video opened: "+d),s().Media.open(d,t,"wistia")),e.bind("play",(function(){void 0!==s().Media.list[this.name()]&&"object"!=typeof s().Media.list[this.name()]&&(_satellite.logger.log("WISTIA Tracking: the video opened: "+this.name()),s().Media.open(this.name(),this.duration(),"wistia")),_satellite.logger.log("WISTIA Tracking: the video played: "+this.name()),s().Media.play(this.name(),this.time())})),e.bind("pause",(function(){_satellite.logger.log("WISTIA Tracking: the video stoped: "+this.name()),s().Media.stop(this.name(),this.time())})),e.bind("seek",(function(i){_satellite.logger.log("WISTIA Tracking: the video seeked to "+i),s().Media.stop(this.name(),this.time()),s().Media.play(this.name(),i)})),e.bind("end",(function(){_satellite.logger.log("WISTIA Tracking: the video ended: "+this.name()),s().Media.stop(this.name(),this.time()),s().Media.close(this.name())})),e.adobeAnalyicsTrackingApplied=!0)):_satellite.logger.log("WISTIA Tracking: Liteners already bound to Wistia video named: "+d):poll=!0}poll&&_sdi.dtm.video.wistia.timesPolled<30&&_sdi.dtm.video.wistia.pollToBind()},findVideos:function(){_satellite.logger.log("WISTIA Tracking: Looking for videos"),window._wq=window._wq||[],_wq.push({id:"_all",onReady:function(i){_satellite.logger.log("WISTIA Tracking: Found "+i.name()+" videos"),_sdi.dtm.video.wistia.vids.push(i),_sdi.dtm.video.wistia.bindEvents()}})},init:function(){void 0!==window.Wistia?(_sdi.dtm.video.wistia.findVideos(),_sdi.dtm.video.wistia.vids.length>0&&_sdi.dtm.video.wistia.bindEvents()):_satellite.logger.log("WISTIA Tracking: No API detected")}},_sdi.dtm.video.wistia.init();
});</script><script>_satellite["_runScript4"](function(event, target, Promise) {
function addDataMapFromActions(t,e){return e&&e.dataMap&&(t=new Map([...t,...e.dataMap])),t}function extractAnalyticAttributesFromEvent(t){const e=new Map;for(const a of t.composedPath().reverse())if(a.hasAttributes?.())for(const i of a.attributes){if(isAnalyticsEntry(i.name)){let t=lowercaseFirst(i.name.replace("data-analytics-",""));t=normalizeKey(t),setKeyValueToMap(e,t,i.value)}if("data-analytics-data-map"===i.name){const[a,n]=i.value.split(":")??[];if(a===t.type){const a=n.split(",");for(let[i,n]of a.map((t=>t.split("="))))n?e.set(i,n):e.set(i,t[i])}}}return e}function normalizeKey(t){return Object.prototype.hasOwnProperty.call(ATTRIBUTES__MAP,t)&&("region"!==t&&_satellite.logger.warn("Data analytics "+t+" attribute is incorrect. Please review the spec and fix."),t=ATTRIBUTES__MAP[t]),t}function setKeyValueToMap(t,e,a){return t.has(e)?t.set(e,`${t.get(e)}|${a}`):t.set(e,a),t}function mergeSourceToMapFromQueue(t,e,a,i){if(a&&i){const n=t.get(i);n&&(t.set(i,{...n,...e,attributes:new Map([...n.attributes,...e.attributes]),clicked:e.clicked||n.clicked}),t.delete(a))}}const EVENTS=Object.freeze({PFE_NAV_EXPAND:"pfe-navigation:expanded-item",PFE_NAV_COLLAPSE:"pfe-navigation:collapsed-item",PFE_ACCORDION_CHANGE:"pfe-accordion:change",PFE_TABS_SHOWN:"pfe-tabs:shown-tab",RH_TAB_EXPAND:"tab-expand"});class MessageEvent extends Event{constructor(t){super("message"),this.detail={...this.detail,...t}}}class AnalyticsManager extends EventTarget{constructor(){super(),this._actions=new Map,this._messageQueue=new Map,this._listners=new Set,this._eventListenerHandler=this.eventListenerHandler.bind(this),this.registerEventListener("click"),this.scanEventMaps()}scanEventMaps(){for(const t of document.querySelectorAll("[data-analytics-event-map]")){const[e]=t.getAttribute("data-analytics-event-map")?.split?.(":")??[];e&&this.registerEventListener(e)}}registerEventListener(t,e={},a=document){this._listners.has(t)||(a.addEventListener(t,this._eventListenerHandler),this._actions.set(t,e),this._listners.add(t))}eventListenerHandler(t){const e=findRootElement(t);if(!e)return;if(this._messageQueue.has(t.type))return;let a=new Map;a=addDataMapFromActions(a,this._actions.get(t.type)),a=new Map([...a,...extractAnalyticAttributesFromEvent(t)]),a=addAttributes(e,a),this._messageQueue.set(t.type,{type:t.type,tagName:t.target.tagName,attributes:a,rootElement:e,eventDetail:"object"==typeof t.detail&&null!==t.detail?t.detail:{},track:this._actions.get(t.type).track,clicked:"click"===t.type}),requestAnimationFrame((()=>{if(this._messageQueue.size>0){const e=new Map(this._messageQueue);this._messageQueue=new Map;for(const[t,a]of e){const[t,i]=a.attributes?.get?.("data-analytics-event-map")?.split(":")??[];mergeSourceToMapFromQueue(e,a,t,i)}for(const[a,i]of e){const a=t.type,n=this._actions?.get?.(t.type)?.merge;mergeSourceToMapFromQueue(e,i,a,n)}for(let[t,a]of e)this.dispatchEvent(new MessageEvent({...a,eventMapped:!0}))}}))}}const analyticsManager=new AnalyticsManager;analyticsManager.registerEventListener(EVENTS.PFE_NAV_EXPAND,{merge:"click",dataMap:new Map([["event","Mega Menu Expanded"]])}),analyticsManager.registerEventListener(EVENTS.PFE_NAV_COLLAPSE,{merge:"click",dataMap:new Map([["event","Mega Menu Collapsed"]]),track:!1});const tabActions={merge:"click",dataMap:new Map([["event","Tab Link Clicked"],["isTab",!0]])};analyticsManager.registerEventListener(EVENTS.PFE_ACCORDION_CHANGE,tabActions),analyticsManager.registerEventListener(EVENTS.PFE_TABS_SHOWN,tabActions),analyticsManager.addEventListener("message",(t=>{if(t instanceof MessageEvent){const{eventMapped:a}=t.detail;if(a){const{attributes:a,rootElement:i,track:n,clicked:s}=t.detail;if(!1===n||!1===s)return;var e=buildDataObject(i,a);e.event&&pushEvent(e)}}}));var dataLayerName="appEventData",reservedAttributes=["event"],downloadExtensions=["doc","docx","eps","epub","jpg","png","svg","xls","ppt","pptx","pdf","xlsx","tab","csv","zip","txt","vsd","vxd","xml","js","css","rar","exe","wma","mov","avi","wmv","mp3","wav","m4v"],addAttributes=function(t,e){let a=!1,i=[];if(("Tab Link Clicked"!==e.get("event")||!e.has("tabHref"))&&(isTab(t)||e.get("isTab"))){a=!0,e.set("event","Tab Link Clicked");let n=t.getAttribute("href")||getLinkText(t)||"";n=n.trim(),e.set("tabHref",n),i.push("isTab")}if(!e.has("isJavascript")&&isJavascript(t)&&(a=!0,e.set("isJavascript",!0),i.push("isJavascript")),e.has("isDownload")&&e.has("fileName")||!isDownload(t)||(a=!0,e.set("isDownload",!0).set("fileName",t.href.split("/").pop()),i.push("isDownload")),e.has("isCrossPropertyDomain")&&e.has("linkTypeName")||!isCrossPropertyDomain(t)||(a=!0,e.set("isCrossPropertyDomain",!0).set("linkTypeName","cross property link"),i.push("isCrossPropertyDomain")),e.has("isCta")&&e.has("linkTypeName")||!isCta(t)||(a=!0,e.set("isCta",!0).set("linkTypeName","cta link"),i.push("isCta")),!e.has("isFooter")&&isFooter(t)&&(a=!0,e.set("isFooter",!0),i.push("isFooter")),!e.has("isInternalCampaign")&&isInternalCampaign(t)&&(a=!0,e.set("isInternalCampaign",!0),i.push("isInternalCampaign")),!e.has("isPromoSection")&&isPromoSection(t)&&(a=!0,e.set("isPromoSection",!0),i.push("isPromoSection")),(!e.has("isSearchContainer")||void 0===!e.has("linkTypeName"))&&isSearchContainer(t)){a=!0;let n=parseInt(t.getAttribute("data-render-position")||0)+1;e.set("isSearchContainer",!0).set("linkTypeName","search result click").set("searchQuery",_sdi.util.getQueryParam("search")).set("searchResultNum",n),i.push("isSearchContainer")}return e.has("isGemini")&&e.has("geminiEvalId")&&e.has("geminiOfferId")||!isGemini(t)||(a=!0,e.set("isGemini",!0).set("geminiEvalId",t.getAttribute("data-rh-gemini-evaluation-id")).set("geminiOfferId",t.getAttribute("data-rh-gemini-offer-id")),i.push("isGemini")),e.has("isExitLink")&&e.has("linkTypeName")||!isExitLink(t)||(a=!0,e.set("isExitLink",!0).set("linkTypeName","exit link"),i.push("isExitLink")),e.has("isSocial")&&!e.has("linkTypeName")||!isSocial(t)||(a=!0,e.set("isSocial",!0).set("linkTypeName","social link"),i.push("isSocial")),e.set("targetHost",getHostName(t.href)).set("internalCampaign",window._sdi.util.getQueryParam("icid",t.href)||window._sdi.util.getQueryParam("intcmp",t.href)||""),!0===a&&(console.debug("Attributes are set via DOM parsing. Please use the analytics map to declare analytics data."),console.debug("Attributes set via DOM parsing:",i)),e},getLinkText=function(t){return redactEmail(t.getAttribute("data-analytics-text")||t.getAttribute("sObjectId")||t.getAttribute("s-object-id")||t.getAttribute("sObjectID")||t.getAttribute("data-s-object-id")||t.innerText&&""!==t.innerText.trim()&&t.innerText.trim()||t.textContent&&""!==t.textContent.trim()&&t.textContent.trim()||t.querySelector("[alt]")&&t.querySelector("[alt]").getAttribute("alt")||t.querySelector("[title]")&&t.querySelector("[title]").getAttribute("title")||t.getAttribute("aria-label")||t.href||"unknown")},getRegions=function(t,e){if(e=e||[],!t)return e;var a=t.closest("[data-analytics-region]");return a?(e.push(a.dataset.analyticsRegion),e=getRegions(a.parentElement,e)):e},removeReservedAttributes=function(t){return reservedAttributes.forEach((function(e){t.delete(e)})),t},attributesMapToArray=function(t){const e=[];return t.forEach(((t,a)=>e[a]=t)),e},redactEmail=function(t){return t.replace(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,6}/gi,"email_address_redacted")},buildDataObject=function(t,e,a){return a=a||getRegions(t),{event:buildEventName(t,e,a),linkInfo:Object.assign({href:t.href,regions:a.constructor===Array?a.reverse().join("|"):a,text:getLinkText(t)},attributesMapToArray(removeReservedAttributes(e)))}},buildEventName=function(t,e){return e.has("event")?e.get("event"):"Master Link Clicked"},findRootElement=function(t){var e;if(Object.values([EVENTS.PFE_NAV_EXPAND,EVENTS.PFE_NAV_COLLAPSE,EVENTS.PFE_ACCORDION_CHANGE]).includes(t.type))e=t.detail.toggle;else if(t.type===EVENTS.PFE_TABS_SHOWN){const a=t.target.closest("pfe-content-set");if("PFE-CONTENT-SET"===t.target.tagName){const i=t.detail.tab.querySelector("slot");e=a.getSlot(i.getAttribute("name"))[0]}}else"PFE-TAB"===t.target.tagName||"RH-TAB"===t.target.tagName?e=t.target:"click"===t.type&&"PFE-CONTENT-SET"===t.target.tagName?e=t.target.shadowRoot.activeElement:void 0!==t.target&&(e=t.target.closest('a, button, [data-analytics-event], [role="button"]'));return e||t.composedPath().find((t=>"A"===t.tagName||"BUTTON"===t.tagName||"function"==typeof t.hasAttribute&&t.hasAttribute("data-analytics-event")))},isJavascript=function(t){return new RegExp("^javascript:","i").test(t.href)},isDownload=function(t){return new RegExp("("+downloadExtensions.join("|")+")$","i").test(t.href)},isExitLink=function(t){return!!t.href&&!new RegExp(_satellite.getVar("exitExclusionArray").join("|"),"i").test(t.href)},isSocial=function(t){var e=new RegExp(_satellite.getVar("socialDomainList").join("$|")+"$","i"),a=getHostName(t.href);return e.test(a)},isCrossPropertyDomain=function(t){return document.location.hostname!==getHostName(t.href)&&"access.cdn.redhat.com"!==getHostName(t.href)&&new RegExp(_satellite.getVar("redHatDomains").join("|"),"i").test(getHostName(t.href))},isCta=function(t){var e=["pfe-cta a",".cta-primary",".account-register-link","a.rh-cta-link","p.cta-group a","[data-ux-cta-type*='video-play']","div.ux-cta a.ux-cta-link:not([data-ux-cta-type*='video-play'])","a.rh-promo-cta-link","[data-rh-cta-type='primary']","[data-ux-cta-type='primary']","rh-cta a"];for(let a=0;a<e.length;a++)if(t.matches(e[a])||null!==t.closest(e[a]))return!0},isTab=function(t){return t.classList.contains('[data-toggle="tab"]')||t.classList.contains("pfe-accordion-header")||t.classList.contains('[role="tab"]')||t.classList.contains("ux-vtab-nav-link")||t.classList.contains("ux-tile-nav-link")||t.classList.contains("btn-brick")||t.classList.contains("ux-htab-nav-link")||t.classList.contains("ux-horizontal-tab-nav-link")||t.classList.contains("ux-oss-hub-filter-type-text")||t.classList.contains("ux-htabb-nav-link")||"tab"===t.getAttribute("data-toggle")||"PFE-ACCORDION-HEADER"===t.tagName||"tab"===t.getAttribute("role")||"RH-TAB"===t.tagName},isFooter=function(t){let e=t.closest("footer");return void 0!==e&&null!=e},isInternalCampaign=function(t){let e;return(""!=window._sdi.util.getQueryParam("icid",t.href)||""!=window._sdi.util.getQueryParam("intcmp",t.href))&&(e=t.getAttribute("role")||"",_satellite.logger.log("isInternalCampaign: linkRole:",e),"tab"!==e||void 0)},isPromoSection=function(t){let e=t.closest("div.band-hero");return void 0!==e&&null!=e},isSearchContainer=function(t){_satellite.logger.log("isSearchContainer ran");let e=t.closest("div.cp-sidebar")||t.closest("div.cp-search-results")||t.closest("div.rhdc-search-listing--content a");return _satellite.logger.log("isSearchContainer el",e),_satellite.logger.log("isSearchContainer return",void 0!==e&&null!=e),void 0!==e&&null!=e},isGemini=function(t){var e=["div.ux-cta a[data-rh-gemini-evaluation-id].ux-cta-link","div.rc-cta-primary a[data-rh-gemini-evaluation-id].ux-cta-link"];for(let a=0;a<e.length;a++)if(t.matches(e[a]))return!0},getHostName=function(t){let e=document.createElement("a");return e.href=t,e.hostname},pushEvent=function(t){window.appEventData=window.appEventData||[],console.info("Pushing to the dataLayer",t);var e=window[dataLayerName];Array.isArray(e)&&e.push(t)};const isAnalyticsEntry=t=>t.startsWith("data-analytics-"),lowercaseFirst=t=>`${t.charAt(0).toLowerCase()}${t.slice(1)}`,ATTRIBUTES__MAP={filename:"fileName",internalcampaign:"internalCampaign",isdownload:"isDownload",iscrosspropertydomain:"isCrossPropertyDomain",istab:"isTab",linktype:"linkType",linktypename:"linkTypeName",region:"regions"};
});</script><script>_satellite["_runScript5"](function(event, target, Promise) {
void 0!==_sdi.util.loadScript&&_sdi.util.loadScript("https://www.googletagmanager.com/gtag/js?id=DC-10727170",(function(){window.dataLayer=window.dataLayer||[],window.gtag=function(){dataLayer.push(arguments)},gtag("js",new Date),gtag("config","DC-10727170"),gtag("config","AW-991646916"),gtag("event","conversion",{allow_custom_scripts:!0,u1:window.location.hostname+window.location.pathname,send_to:"DC-10727170/unive0/redha0+standard"})}));
});</script><iframe height="0" width="0" style="display: none; visibility: hidden;" src="Ansible%20module%20architecture%20%E2%80%94%20Ansible%20Community%20Documentation-Dateien/activityi.html"></iframe><script>_satellite["_runScript6"](function(event, target, Promise) {
if("yes"==_satellite.getVar("tagsAllowedFunc")&&"yes"==_satellite.getVar("rhMarketingLoaded")){var scCid=_satellite.cookie.get("rh_omni_tc");if(""!==scCid&&void 0!==scCid)for(var updatedLink="",anchors=window.document.getElementsByTagName("a"),i=0;i<anchors.length;i++)(anchors[i].href.indexOf("vts.inxpo.com")>-1||anchors[i].href.indexOf("onlinexperiences.com")>-1)&&-1==anchors[i].href.toLowerCase().indexOf("affiliatedata=")&&""!==(updatedLink=window._sdi.util.appendQuery(anchors[i].href,"AffiliateData",scCid))&&(anchors[i].href=updatedLink)}
});</script><div class="st-injected-content-generated st-install-yABGvz2N8PwcwBxyfzUc" data-st-install-key="yABGvz2N8PwcwBxyfzUc" id="st-injected-content">
<div class="st-ui-embed st-search-chrome-overlay-output st-search-escape-hide-outputs st-search-zoom-on-mobile" style="display: none;">
  
    <div class="st-ui-overlay st-search-hide-outputs"></div>
  
  <!-- Swiftype input and results overlay -->
  
  <div class="st-ui-container st-ui-container-overlay  st-ui-injected-overlay-container ">
    <!-- HEADER -->
    <div class="st-ui-container-header_bar st-position-container">
      
        <section class="st-ui-header">
          <form>
            <input class="st-default-search-input st-search-set-focus" type="text" placeholder="Search this site" aria-label="Search this site" id="st-overlay-search-input" autocomplete="off" autocorrect="off" autocapitalize="none">
          </form>
          <span class="st-ui-search-icon"></span>

          
            <a class="st-ui-close-button st-search-hide-outputs">Close</a>
          

          
        </section>
      
    </div>

    <!-- LEFT SIDEBAR -->
    <div class="st-ui-container-left_sidebar st-position-container">
      
      <div class="st-ui-injected-search-controls">
        
          
        
      </div>
    </div>

    <!-- RIGHT SIDEBAR -->
    <div class="st-ui-container-right_sidebar st-position-container">
      
      <div class="st-ui-injected-container-right_sidebar">
        <div class="st-ui-injected-search-controls">
          
            
          
        </div>
      </div>
    </div>

    <!-- PRIMARY CONTENT -->
    <div class="st-ui-container-primary_content st-position-container">
      
        <section class="st-ui-slide-autocomplete st-autocomplete-keyboard-navigable st-autocomplete-transient-on-select-and-results" data-st-target-element="#st-overlay-search-input" data-st-active-query-class="active" style="display: none;">
          <span class="st-ui-type-heading-small">suggested results</span>
          <div class="st-autocomplete-results"><div class="st-query-present" style="display: none;"></div></div>
        </section>

        <section class="st-ui-content st-search-results"><div class="st-query-not-present">
          <span class="st-ui-fallback"></span>
        </div><div class="st-query-present" style="display: none;"></div></section>
      

      <section class="st-ui-no-results st-search-suggestions"><div class="st-query-not-present">
      </div></section>
    </div>



    <!-- FOOTER -->
    <div class="st-ui-container-footer_bar st-position-container">
      <section class="st-ui-footer">
        
          <span class="st-ui-search-summary st-search-summary" aria-live="polite"></span>
        
        <span class="st-ui-pagination st-search-pagination"></span>
      </section>
    </div>
  </div>
</div>
<div class="st-default-autocomplete" data-st-target-element=".st-default-search-input" style="display: none; position: absolute; top: 49px; left: 0px; z-index: 999999;">
  <div class="st-autocomplete-results st-ui-autocomplete"><div class="st-query-present" style="display: none;"></div></div>
</div>
<a class="st-search-show-outputs st-ui-search-tab">Search this site</a></div></body></html>